require=function o(n,r,l){function c(e,t){if(!r[e]){if(!n[e]){var a="function"==typeof require&&require;if(!t&&a)return a(e,!0);if(h)return h(e,!0);var i=new Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}var s=r[e]={exports:{}};n[e][0].call(s.exports,function(t){return c(n[e][1][t]||t)},s,s.exports,o,n,r,l)}return r[e].exports}for(var h="function"==typeof require&&require,t=0;t<l.length;t++)c(l[t]);return c}({1:[function(t,e,a){window.app=function(){window.browser=t("browser"),window.breakpoints=t("breakpoints"),window.$=window.jQuery=t("jquery"),window.md5=t("md5"),t("jquery.touch"),t("web");t("form"),t("tabs");var c={tmp:null,buildTimestamp:1599701174195,languages:{ab:"Abkhazian",aa:"Afar",af:"Afrikaans",ak:"Akan",sq:"Albanian",am:"Amharic",ar:"Arabic",an:"Aragonese",hy:"Armenian",as:"Assamese",av:"Avaric",ae:"Avestan",ay:"Aymara",az:"Azerbaijani",bm:"Bambara",ba:"Bashkir",eu:"Basque",be:"Belarusian",bn:"Bengali",bh:"Bihari languages",bi:"Bislama",nb:"Bokmål, Norwegian",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",km:"Central Khmer",ch:"Chamorro",ce:"Chechen",ny:"Chichewa",zh:"Chinese",cu:"Church Slavic",cv:"Chuvash",kw:"Cornish",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",dv:"Divehi",nl:"Dutch",dz:"Dzongkha",en:"English",eo:"Esperanto",et:"Estonian",ee:"Ewe",fo:"Faroese",fj:"Fijian",fi:"Finnish",fr:"French",ff:"Fulah",gd:"Gaelic",gl:"Galician",lg:"Ganda",ka:"Georgian",de:"German",el:"Greek",gn:"Guarani",gu:"Gujarati",ht:"Haitian",ha:"Hausa",he:"Hebrew",hz:"Herero",hi:"Hindi",ho:"Hiri Motu",hu:"Hungarian",is:"Icelandic",io:"Ido",ig:"Igbo",id:"Indonesian",ia:"Interlingua",ie:"Interlingue",iu:"Inuktitut",ik:"Inupiaq",ga:"Irish",it:"Italian",ja:"Japanese",jv:"Javanese",kl:"Kalaallisut",kn:"Kannada",kr:"Kanuri",ks:"Kashmiri",kk:"Kazakh",ki:"Kikuyu",rw:"Kinyarwanda",ky:"Kirghiz",kv:"Komi",kg:"Kongo",ko:"Korean",kj:"Kuanyama",ku:"Kurdish",lo:"Lao",la:"Latin",lv:"Latvian",li:"Limburgan",ln:"Lingala",lt:"Lithuanian",lu:"Luba-Katanga",lb:"Luxembourgish",mk:"Macedonian",mg:"Malagasy",ms:"Malay",ml:"Malayalam",mt:"Maltese",gv:"Manx",mi:"Maori",mr:"Marathi",mh:"Marshallese",mn:"Mongolian",na:"Nauru",nv:"Navajo",nd:"Ndebele, North",nr:"Ndebele, South",ng:"Ndonga",ne:"Nepali",se:"Northern Sami",no:"Norwegian",nn:"Norwegian Nynorsk",oc:"Occitan",oj:"Ojibwa",or:"Oriya",om:"Oromo",os:"Ossetian",pi:"Pali",pa:"Panjabi",fa:"Persian",pl:"Polish",pt:"Portuguese","pt-br":"Portuguese, Brazilian",ps:"Pushto",qu:"Quechua",ro:"Romanian",rm:"Romansh",rn:"Rundi",ru:"Russian",sm:"Samoan",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sr:"Serbian",sn:"Shona",ii:"Sichuan Yi",sd:"Sindhi",si:"Sinhala",sk:"Slovak",sl:"Slovenian",so:"Somali",st:"Sotho, Southern",es:"Spanish",su:"Sundanese",sw:"Swahili",ss:"Swati",sv:"Swedish",tl:"Tagalog",ty:"Tahitian",tg:"Tajik",ta:"Tamil",tt:"Tatar",te:"Telugu",th:"Thai",bo:"Tibetan",ti:"Tigrinya",to:"Tonga",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",tw:"Twi",ug:"Uighur",uk:"Ukrainian",ur:"Urdu",uz:"Uzbek",ve:"Venda",vi:"Vietnamese",vo:"Volapük",wa:"Walloon",cy:"Welsh",fy:"Western Frisian",wo:"Wolof",xh:"Xhosa",yi:"Yiddish",yo:"Yoruba",za:"Zhuang",zu:"Zulu"},touch:{useTouch:!0,useMouse:!0,dragStartEvents:"dragStart tapAndHold",dragPreventDefault:!1,scrollbars:!0},flags:{incompleteSVG:!1},registry:{get:function(t){return localStorage.getItem(t)},set:function(t,e){return localStorage.setItem(t,e)},unset:function(t){return localStorage.removeItem(t)},exists:function(t){return null!==localStorage.getItem(t)}},temp:{get:function(t){return sessionStorage.getItem(t)},set:function(t,e){return sessionStorage.setItem(t,e)},unset:function(t){return sessionStorage.removeItem(t)},exists:function(t){return null!==sessionStorage.getItem(t)}},flag:{has:function(t,e){return web.bit.has(t,e)},set:function(t,e){return web.bit.on(t,e)},unset:function(t,e){return web.bit.off(t,e)}},dialog:{$wrapper:null,$inner:null,$content:null,$actions:null,$notice:null,timeoutId:null,init:function(){var e=this;this.$wrapper=$('<div id="dialog" class="modal" tabindex="-1"><section class="inner"><div class="content"></div><ul class="actions special"></ul><p class="notice"></p><span class="close do-close"><svg><use xlink:href="#icon-cancel"></use></svg></span></section></div>').on("mousedown",function(t){t.preventDefault(),t.stopPropagation(),e.inPreshow()||e.hide()}).on("click mousedown",".inner",function(t){t.stopPropagation()}).on("click",".do-close",function(t){t.preventDefault(),t.stopPropagation(),e.hide()}).on("keydown",function(t){switch(t.keyCode){case 13:if(e.inPreshow())return;e.$actions.find("li > span").first().not(".disabled").trigger("click");break;case 27:if(e.inPreshow())return;e.hide()}}),this.$inner=this.$wrapper.find(".inner"),this.$content=this.$wrapper.find(".content"),this.$actions=this.$wrapper.find(".actions"),this.$notice=this.$wrapper.find(".notice")},show:function(t){var e,a,i=this,s=0;for(this.$wrapper.appendTo(c.$body),e=$.extend({content:null,title:"Alert",message:"Something happened apparently.",html:!1,class:null,dockable:!1,confirmation:!1,error:!1,actions:{Okay:function(){this.hide()}},notice:null,show:null},t),this.$content.children().remove(),e.content?this.$content.html(e.content):(e.title&&this.$content.append('<h2 class="title">'+e.title+"</h2>"),e.message&&this.$content.append('<div class="message">'+(e.html?e.message:"<p>"+e.message+"</p>")+"</div>")),null===e.notice?this.$notice.hide():this.$notice.show().html(e.notice),this.$actions.children().remove(),null===e.actions?this.$actions.hide():(this.$actions.show(),s=0,$.each(e.actions,function(t,a){$('<li><span class="button'+(0==s++?e.error?" error":" special":"")+(!1===a?" disabled":"")+'">'+t+"</span></li>").appendTo(i.$actions).on("click",".button",function(t){var e=$(this);t.preventDefault(),t.stopPropagation(),e.hasClass("disabled")||a.apply(i)})})),e.confirmation&&(i.$actions.find("li > span").first().addClass("disabled"),this.$content.append('<div class="confirmation"><input type="checkbox" id="dialog-confirmation" /><label for="dialog-confirmation">'+e.confirmation+"</label></div>"),this.$content.find('input[type="checkbox"]').on("change",function(){var t=$(this),e=i.$actions.find("li > span").first();t.prop("checked")?e.removeClass("disabled"):e.addClass("disabled")})),e.show&&e.show.apply(this),a=this.$wrapper[0].classList,s=0;s<a.length;s++)"modal"!=a[s]&&"preshow"!=a[s]&&"visible"!=a[s]&&this.$wrapper.removeClass(a[s]);e.class&&this.$wrapper.addClass(e.class),e.dockable&&(c.$body.css("overflow","hidden"),c.$window.on("resize.dialog",function(){clearTimeout(i.timeoutId),i.timeoutId=setTimeout(function(){var t=c.$window.height(),e=i.$inner.height();i.$wrapper.hasClass("docked")?e<t&&i.$wrapper.removeClass("docked"):t<e&&i.$wrapper.addClass("docked")},25)}).trigger("resize.dialog")),window.setTimeout(function(){i.$wrapper.removeClass("preshow"),i.$wrapper.addClass("visible"),window.setTimeout(function(){i.$wrapper.focus()},150)},100)},hide:function(){var t=this;this.$wrapper.removeClass("visible"),window.setTimeout(function(){t.$content.children().remove(),t.$notice.html(""),t.$actions.children().remove(),c.$body.css("overflow",""),c.$window.off("resize.dialog"),clearTimeout(t.timeoutId)},125)},preshow:function(t){var e=this;this.$wrapper.appendTo(c.$body),this.$wrapper.addClass("preshow"),t?this.$wrapper.removeClass("with-spinner"):this.$wrapper.addClass("with-spinner"),window.setTimeout(function(){e.$wrapper.addClass("visible")},100),window.setTimeout(function(){e.$wrapper.focus()},250)},inPreshow:function(){return this.$wrapper.hasClass("preshow")}},progressOverlay:{$wrapper:null,$progress:null,$status:null,options:null,autoIntervalId:null,autoProgressHandler:null,autoStatusHandler:null,init:function(){this.$wrapper=$('<div id="progress-overlay" tabindex="-1"><div class="progress"></div><div class="status"></div></div>'),this.$progress=this.$wrapper.find(".progress"),this.$status=this.$wrapper.find(".status")},show:function(t){var e,a=this;for(0==this.$wrapper.parent().length&&this.$wrapper.appendTo(c.$body),this.options=$.extend({class:null,scrollLock:!1},t),this.$progress.attr("data-value","0"),this.$status.text(""),e=this.$wrapper[0].classList,i=0;i<e.length;i++)"visible"!=e[i]&&this.$wrapper.removeClass(e[i]);this.options.class&&this.$wrapper.addClass(this.options.class),a.$wrapper.addClass("visible"),this.options.scrollLock&&c.$body.css("overflow","hidden"),window.setTimeout(function(){a.$wrapper.focus()},100),window.setTimeout(function(){a.$wrapper.addClass("active")},250)},hide:function(){var t=this;this.autoIntervalId&&(clearInterval(this.autoIntervalId),this.progress(this.autoProgressHandler(100),this.autoStatusHandler?this.autoStatusHandler(100):void 0)),t.$wrapper.removeClass("active"),setTimeout(function(){t.$progress.attr("data-value","0"),t.$status.text(""),t.$wrapper.removeClass("visible"),t.options.scrollLock&&c.$body.css("overflow",""),t.options=null},250)},progress:function(t,e,a){if(void 0===t)return parseInt(this.$progress.attr("data-value"));this.$progress.attr("data-value",t),void 0!==e&&this.status(e,a)},status:function(t){this.$status.text(t)},auto:function(e,t,a,i){var s=this;this.autoProgressHandler=a,this.autoStatusHandler=i,this.autoIntervalId=setInterval(function(){var t;t=Math.min(98,s.progress()+e),s.progress(s.autoProgressHandler(t),s.autoStatusHandler?s.autoStatusHandler(t):void 0)},t)}},$window:null,$document:null,$head:null,$body:null,$html:null,URL_PLACEHOLDER:"https://domain.ext/path",dataUrl:{is:function(t){return"string"==typeof t&&!!t.match(/^data:/)},createFromUrl:function(t,a){var e;(e=new XMLHttpRequest).open("GET",t,!0),e.responseType="blob",e.onload=function(t){var e;(e=new FileReader).onloadend=function(){a(e.result)},e.readAsDataURL(this.response)},e.send()}},objectUrl:{list:{},is:function(t){return"string"==typeof t&&!!t.match(/^blob:/)},get:function(t){return t in this.list?this.list[t]:null},create:function(t){var e;return e=void 0!==window.webkitURL?window.webkitURL.createObjectURL(t):void 0!==window.URL?window.URL.createObjectURL(t):null,this.list[e]=t,e},revoke:function(t){void 0!==window.webkitURL?window.webkitURL.revokeObjectURL(t):void 0!==window.URL&&window.URL.revokeObjectURL(t),t in this.list&&delete this.list[t]},clone:function(t){var e=this.get(t);return app.objectUrl.create(e.slice())},createFromUrl:function(t,a){var i,s=this;(i=new XMLHttpRequest).open("GET",t,!0),i.responseType="arraybuffer",i.onload=function(t){var e;e=s.create(new Blob([new Uint8Array(this.response)],{type:i.getResponseHeader("content-type")})),a(e)},i.send()}},round:function(t,e){var a="number"==typeof e?Math.pow(10,e):1;return Math.round(t*a)/a},markdownify:function(e,t){var a,i,s=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=web.escapeHTML(e)).replace(/\\_/g,"%5C%5F")).replace(/\\\*/g,"%5C%2A")).replace(/\\~/g,"%5C%7E")).replace(/\\`/g,"%5C%80")).replace(/\\=/g,"%5C%3D")).replace(/\\-/g,"%5C%2D")).replace(/\\\(/g,"%5C%28")).replace(/\\\)/g,"%5C%29")).replace(/\\\[/g,"%5C%5B")).replace(/\\\]/g,"%5C%5C")).replace(/\\\{/g,"%5C%7B")).replace(/\\\}/g,"%5C%7D")).match(/\[([^\]]+?)\]\(([^\s\)]+?)\)/g);if(s&&0<s.length)for(i in s)e=e.replace(s[i],s[i].replace(/_/g,"%5F"));return a=e.match(/\[[^\[\]]+?\]\{[^\s\}]+?\}/g),Array.isArray(a)&&a.forEach(function(t){(t.match(/\[[^\[\]]+?\]\{[a-zA-Z]+?\}/g)||t.match(/\[[^\[\]]+?\]\{#[a-fA-F0-9]{6}?\}/g))&&(e=e.replace(t,t.replace(/\[([^\[\]]+?)\]\{([^\s\}]+?)\}/g,'<span style＝"color: $2">$1</span>')))}),e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\[([^\[\]]+?)\]\(([^\s\)]+?)\)/g,'<span class＝"--a" data-href＝"$2">$1</span>')).replace(/__([^_]+?)__/g,'<span class＝"--u">$1</span>')).replace(/\*\*\*([^\*]+?)\*\*\*/g,'<span class＝"--strong"><span class＝"--em">$1</span></span>')).replace(/\*\*([^\*]+?)\*\*/g,'<span class＝"--strong">$1</span>')).replace(/\*([^\*]+?)\*/g,'<span class＝"--em">$1</span>')).replace(/_([^_]+?)_/g,'<span class＝"--em">$1</span>')).replace(/`([^`]+?)`/g,'<span class＝"--code">$1</span>')).replace(/~~([^~]+?)~~/g,'<span class＝"--s">$1</span>')).replace(/==([^=]+?)==/g,'<span class＝"--mark">$1</span>'),!0===t&&(e=e.replace(/(^|\n)- (.+)/g,'$1<span class＝"--li">$2</span>')),e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/＝/g,"=")).replace(/%5C%5F/g,"_")).replace(/%5C%2A/g,"*")).replace(/%5C%7E/g,"~")).replace(/%5C%80/g,"`")).replace(/%5C%3D/g,"=")).replace(/%5C%2D/g,"-")).replace(/%5C%28/g,"(")).replace(/%5C%29/g,")")).replace(/%5C%5B/g,"[")).replace(/%5C%5C/g,"]")).replace(/%5C%7B/g,"{")).replace(/%5C%7D/g,"}")).replace(/%5F/g,"_")},hasMarkdown:function(t,e){switch(t){case"link":return!!e.match(/\[(.+?)\]\(([^\[\]]+?)\)/g);case"strong":return!!e.match(/\*\*([^\*]+?)\*\*/g)||!!e.match(/__([^_]+?)__/g);case"emphasis":return!!e.match(/\*([^\*]+?)\*/g)||!!e.match(/_([^_]+?)_/g);case"code":return!!e.match(/`([^`]+?)`/g);case"strike":return!!e.match(/~~([^~]+?)~~/g);case"highlight":return!!e.match(/==([^=]+?)==/g);case"list-item":return!!e.match(/(^|\n)- (.+)/g)}return!1},transparentize:function(t,e){var a,i;return 1==e||"#"!=t.charAt(0)||7!=t.length&&9!=t.length?t:(a=t.substr(0,7),i=9==t.length?parseInt(t.substr(7,2),16):255,1==(i=parseInt(i*e).toString(16)).length&&(i="0"+i),(a+i).toUpperCase())},htmlaToHtml:function(t){return 9==t.length?t.substr(0,7):t},htmlToMatrixValues:function(t){var e;for(i in"#"==t.charAt(0)&&(t=t.substr(1)),e=[t.substr(0,2),t.substr(2,2),t.substr(4,2),t.substr(6,2)])e[i]=""!==e[i]?parseInt(e[i],16)/256:1;return e[0]+" 0 0 0 0 0 "+e[1]+" 0 0 0 0 0 "+e[2]+" 0 0 0 0 0 "+e[3]+" 0"},htmlTorgb:function(t,e){var a,i;if("string"!=typeof t)return"rgba(0,0,0,"+(void 0!==e?e:"")+")";for(i in"#"==t.charAt(0)&&(t=t.substr(1)),a=[t.substr(0,2),t.substr(2,2),t.substr(4,2)])a[i]=parseInt(a[i],16);return a=a.join(","),void 0!==e?"rgba("+a+","+e+")":"rgb("+a+")"},CSSPositionValue:function(t){var e;switch(t){case"top-left":e="top left";break;case"top":e="top";break;case"top-right":e="top right";break;case"right":e="right";break;case"bottom-right":e="bottom right";break;case"bottom":e="bottom";break;case"bottom-left":e="bottom left";break;case"left":e="left";break;case"center":default:e="center"}return e},CSSRepeatValue:function(t){var e;switch(t){case"horizontal":e="repeat-x";break;case"vertical":e="repeat-y";break;case"both":e="repeat";break;default:case"off":e="no-repeat"}return e},CSSSizeValue:function(t,e){var a;switch(t){case"stretch":a="100% 100%";break;case"fit":a="contain";break;case"fill":a="cover";break;case"custom":a=e+"rem";break;case"default":default:a="auto"}return a},cleanHref:function(){var t=window.location.href;return-1!==t.indexOf("?")&&(t=t.split("?")[0]),t},cleanBaseHref:function(){return window.location.protocol+"//"+window.location.hostname},normalizeWheel:function(t){var e=0,a=0,i=0,s=0;return"detail"in t?a=t.detail:"wheelDelta"in t?a=t.wheelDelta/-120:"wheelDeltaY"in t&&(a=t.wheelDeltaY/-120),"wheelDeltaX"in t&&(e=t.wheelDeltaX/-120),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=a,a=0),i=10*e,s=10*a,"deltaY"in t&&(s=t.deltaY),"deltaX"in t&&(i=t.deltaX),(i||s)&&t.deltaMode&&(1==t.deltaMode?(i*=40,s*=40):(i*=800,s*=800)),i&&!e&&(e=i<1?-1:1),s&&!a&&(a=s<1?-1:1),{spinX:e,spinY:a,pixelX:i,pixelY:s}},scrollify:function(n,t){var r,l=$.extend({middle:!1,replay:!1,delay:0,offset:0,duration:0,onPlay:null},t);l.replay&&n.on("click",function(t){t.preventDefault(),t.stopPropagation(),n.hasClass("played")&&(n.removeClass("played").removeClass("active").removeClass("paused"),setTimeout(function(){n.addClass("active"),l.onPlay&&l.onPlay(n),setTimeout(function(){n.addClass("played")},l.duration)},250))}),c.$window.on("scroll",function(t){var e,a=$(document).scrollTop(),i=window.innerHeight,s=n.offset().top,o=n.offset().top+n.outerHeight();n.hasClass("active")?n.hasClass("paused")?a<o&&s<a+i&&n.removeClass("paused"):(o<a||a+i<s)&&n.addClass("paused"):(l.middle?result=s<(e=a+i/2)&&e<o:result=a<o&&s<a+i,result?(clearTimeout(r),r=setTimeout(function(){n.addClass("active"),l.onPlay&&l.onPlay(n),l.replay&&setTimeout(function(){n.addClass("played")},l.duration)},l.delay)):clearTimeout(r))}).triggerHandler("scroll")},scrollTo:function(t){var e,a,i,s,o=$.extend({$context:null,$target:null,callback:null,offset:0,center:!1,speed:750},t);setTimeout(function(){var t;t=o.$context?o.$target.position():(o.$context=$("body,html"),o.$target.offset()),e=o.$context.scrollTop(),a=Math.max(0,t.top+o.offset-(c.$window.height()-(o.center?o.$target.outerHeight():0))/2),i=Math.abs(e-a),s=Math.max(250,Math.min(o.speed,o.speed*(i/(c.$window.height()/2)))),o.$context.stop().animate({scrollTop:a},s,"swing",o.callback)},0)},splitCSSStyles:function(t){var e,a,i,s={},o=["margin","margin-top","margin-bottom"];if(0==(e=t.split("\n")).length)return{};for(i=0;i<e.length;i++)2===(a=e[i].split(":")).length&&(a[0]=a[0].trim(),a[1]=a[1].trim(),web.is("id",a[0])&&";"==a[1].substr(-1)&&(s[a[0]]=a[1].slice(0,-1).replace("!important","")+(-1!=o.indexOf(a[0])?" !important":"")));return s},keyHandler:function(t){var e=$(this);switch(t.keyCode){case 27:t.stopPropagation(),t.preventDefault(),e.blur();break;case 13:t.stopPropagation(),t.preventDefault(),e.trigger("click");break;case 8:case 32:case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:t.preventDefault(),t.stopPropagation()}},init:function(t,e){var a,i,s,h;c.flags.incompleteSVG="edge"==browser.name||"ie"==browser.name,c.$window=$(window),c.$document=$(document),c.$head=$("head"),c.$body=$("body"),c.$html=$("html"),breakpoints({xlarge:["1281px","1680px"],large:["981px","1280px"],medium:["737px","980px"],small:["481px","736px"],xsmall:["361px","480px"],xxsmall:[null,"360px"],xshort:"(max-height: 480px)",short:"(max-height: 640px)",tall:"(min-height: 641px)"}),$.event.special.destroyed={remove:function(t){t.handler&&t.handler()}},Element.prototype._addEventListener=Element.prototype.addEventListener,Element.prototype.addEventListener=function(t,e,a){return"wheel"==t&&(a={passive:!1}),this._addEventListener(t,e,a)},browser.mobile?(c.$body.addClass("is-touch"),c.touch.useTouch=!0,c.touch.useMouse=!1,c.touch.dragStartEvents="tapAndHold",c.touch.dragPreventDefault=function(t){return t.inTapAndHold},c.touch.scrollbars=!1):c.$body.addClass("is-nonTouch"),HTMLCanvasElement.prototype.toBlob||Object.defineProperty(HTMLCanvasElement.prototype,"toBlob",{value:function(s,o,n){var r=this;setTimeout(function(){for(var t=atob(r.toDataURL(o,n).split(",")[1]),e=t.length,a=new Uint8Array(e),i=0;i<e;i++)a[i]=t.charCodeAt(i);s(new Blob([a],{type:o||"image/png"}))})}}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var a=Object(this),i=a.length>>>0;if(0==i)return!1;var s,o,n=0|e,r=Math.max(0<=n?n:i-Math.abs(n),0);for(;r<i;){if((s=a[r])===(o=t)||"number"==typeof s&&"number"==typeof o&&isNaN(s)&&isNaN(o))return!0;r++}return!1}}),"ie"==browser.name&&c.$body.addClass("is-ie"),c.flags.incompleteSVG&&c.$html.addClass("is-incomplete-svg"),c.$window.on("load",function(){window.setTimeout(function(){c.$body.removeClass("is-loading")},100)}),"admin"==c.$body.attr("id")?$("#admin-form-responder").form():$('form:not([method="get"])').form(),c.dialog.init(),c.progressOverlay.init(),c.$body.on("click","a.behavior-replace",function(t){var e=$(this).attr("href");t.preventDefault(),t.stopPropagation(),window.location.replace(e)}),c.$body.on("click","a.behavior-replace-long-wait",function(t){var e=$(this).attr("href");t.preventDefault(),t.stopPropagation(),c.dialog.preshow(),window.setTimeout(function(){window.location.replace(e)},250)}),c.$body.on("click","a.behavior-long-wait",function(t){var e=$(this).attr("href");t.preventDefault(),t.stopPropagation(),c.dialog.preshow(),window.setTimeout(function(){window.location.href=e},750)}),c.$body.on("click","a.behavior-download",function(t){var e=$(this).attr("href");t.preventDefault(),t.stopPropagation(),c.dialog.preshow(),window.setTimeout(function(){window.location.href=e,c.dialog.show({title:"Downloading Zip",message:"Preparing your download. Please wait a moment.",actions:{Dismiss:function(){this.hide()}}})},750)}),c.$body.on("click","a.behavior-requires-confirmation, a.behavior-requires-confirmation-long-wait",function(t){var e=$(this),a=e.attr("data-confirm-href"),i=e.text(),s={};t.preventDefault(),t.stopPropagation(),s[i]=function(){e.hasClass("behavior-requires-confirmation-long-wait")?(c.dialog.preshow(),window.setTimeout(function(){window.location.href=a},750)):window.location.href=a},s.Cancel=function(){this.hide()},c.dialog.show({title:"Are you sure?",message:null,actions:s})}),c.$body.on("click","a.behavior-requires-double-confirmation, a.behavior-requires-double-confirmation-long-wait",function(t){var e=$(this),a=e.attr("data-confirm-href"),i=e.text(),s={};t.preventDefault(),t.stopPropagation(),s[i]=function(){e.hasClass("behavior-requires-double-confirmation-long-wait")?(c.dialog.preshow(),window.setTimeout(function(){window.location.href=a},750)):window.location.href=a},s.Cancel=function(){this.hide()},c.dialog.show({title:"Are you sure?",message:null,confirmation:"Yes, I am sure I want to do this.",actions:s})}),c.$body.on("click",".behavior-requires-more-sites",function(t){var e=$(this),a=parseInt(e.attr("data-sites-limit"));t.preventDefault(),t.stopPropagation(),c.dialog.show({title:"Out of sites :(",message:"Woops! You've reached your account's limit of <strong>"+a+"</strong> sites. Please either change to a different plan or delete a site and try again.",actions:{"Change Plan":function(){this.hide(),window.location.href="/dashboard/account/plan/change"},"Maybe Later":function(){this.hide()}}})}),c.$body.on("click",".behavior-requires-pro-plus",function(t){$(this);t.preventDefault(),t.stopPropagation(),c.dialog.show({title:"Upgrade to Pro Plus",message:"Upgrade to the <strong>Pro Plus</strong> plan and get access to this and many other awesome features.",actions:{"Learn More":function(){this.hide(),window.location.href="/dashboard/account/plan/change"},"Maybe Later":function(){this.hide()}}})}),c.$body.on("click",".behavior-requires-verification",function(t){$(this);t.preventDefault(),t.stopPropagation(),c.dialog.show({title:"Not Verified!",message:"Woops, looks like you haven't verified your account yet! Please click the link in the verification email we sent you before trying to upgrade."})}),c.$body.on("click","a.behavior-recommend-higher-plan",function(t){var e=$(this).attr("href"),a={};t.preventDefault(),t.stopPropagation(),a["Choose a different plan"]=function(){this.hide(),window.location.href="/dashboard/account/plan/change"},a["Continue with this plan"]=function(){this.hide(),window.location.href=e},c.dialog.show({title:"Are you sure?",message:"One or more of your sites uses features not available with this plan. Upgrading to this plan will disable those features on your sites, but will otherwise leave them intact. What would you like to do?",actions:a})}),c.$body.on("click","a.behavior-unusable-plan",function(t){var e=$(this),a=JSON.parse(unescape(e.attr("data-missing-perks")));t.preventDefault(),t.stopPropagation(),c.dialog.show({title:"Can't select plan :(",html:!0,message:'<p>Woops! Your account (or one or more of your sites) is currently using the following features that aren\'t available with the selected plan:</p><ul class="checklist special">'+function(){var t,e="";for(t=0;t<a.length;t++)e+="<li>"+a[t]+"</li>";return e}()+"</ul><p>Please select a different plan that includes the above features, or discontinue using them and try selecting this plan again.</p>"})}),c.$body.on("click","a.behavior-background-fetch",function(t){var e=$(this).attr("href");t.preventDefault(),t.stopPropagation(),fetch(e),setTimeout(function(){window.location.reload()},25)}),c.$body.on("click","ul.brand-selector.behavior-brand-steps > li > a",function(t,a){var e=$(this),i=e.parent(),s=i.siblings(),o=e.parents("li").eq(1),n=o.siblings(),r=window.location.href.split("#")[0],l=e.attr("href").substr(1);t.preventDefault(),t.stopPropagation(),i.hasClass("active")||$.ajax({url:r+"/"+l,type:"GET",dataType:"json",success:function(t){var e;s.removeClass("active"),n.filter("[data-brand]").remove(),i.addClass("active"),e=t.excerpt.replace(/\<li\>/g,'<li data-brand="'+l+'">'),$(e).insertAfter(o),history.replaceState({},null,"#"+l),a||app.scrollTo({$target:o.next()})}})}),$("ul.brand-selector.behavior-brand-steps").each(function(){var t,e=$(this),a=window.location.hash.substr(1);a&&0<(t=e.find('a[href="#'+a+'"]')).length&&t.trigger("click",[!0])}),c.$body.on("click",".snippet",function(t){var e=$(this),a=e.find(".content");if(!e.hasClass("active")){if("clipboard"in navigator)navigator.clipboard.writeText(a.text());else{var i=document.createRange(),s=window.getSelection();a.prop("contentEditable",!0),a.prop("readonly",!0),i.selectNodeContents(a[0]),s.removeAllRanges(),s.addRange(i),document.execCommand("copy"),a.blur(),s.removeAllRanges(),a.prop("contentEditable",!1),a.prop("readonly",!1)}e.addClass("active"),setTimeout(function(){e.removeClass("active")},1e3)}}),$(".printable").each(function(){$(this).find("table").each(function(){var i,t=$(this),e=t.children("tbody").first(),a=t.next(".actions");0!=a.length&&(i='<tr class="editable">',t.find("tr").first().children().each(function(t){var e=$(this)[0].tagName,a="";a+="<"+e+">",a+='<div class="string" contenteditable="true"></div>',0==t&&(a+='<div class="do-delete"></div>'),i+=a+="</"+e+">"}),i+="</tr>",t.on("click",".do-delete",function(t){t.preventDefault(),t.stopPropagation(),$(this).parent().parent().remove()}),a.on("click",".do-add",function(t){t.preventDefault(),t.stopPropagation(),e.append($(i))}))})}),0<$(".defer-loading").length&&(i=$(".defer-loading"),s=c.$body.data("defer-from-id")?$("#"+c.$body.data("defer-from-id")):null,h=s&&0<s.length?s.offset().top:0,i.each(function(){var e=$(this),a=e.children("img").first(),i=a[0];e.css("background-image","url("+a.attr("src")+")").css("background-size","100% auto").css("background-position","top left").css("background-repeat","no-repeat"),a.css("opacity","0").css("transition","opacity 0.375s ease-in-out"),a.on("load",function(t){"done"==a.data("src")&&(Date.now()-i._startLoad<375?(e.removeClass("loading"),e.css("background-image","none"),a.css("transition",""),a.css("opacity","1")):(e.removeClass("loading"),a.css("opacity","1"),setTimeout(function(){e.css("background-image","none")},375)))})}),a=function(){var r=document.documentElement.clientHeight,l="ios"==browser.os?document.body.scrollTop:document.documentElement.scrollTop,c=l+r;i.each(function(){var t=$(this),e=t.children("img").first(),a=e[0];if(null===a.offsetParent)return!0;if("done"===e.data("src"))return!0;var i,s=a.getBoundingClientRect(),o=l+Math.floor(s.top)-r,n=l+Math.ceil(s.bottom)+r;h<c&&o<=c&&l<=n&&(i=e.data("src"),e.data("src","done"),t.addClass("loading"),a._startLoad=Date.now(),e.attr("src",i))})},c.$window.on("load resize scroll",a)),$(".plans").on("click",".plan > header .next:not(.last)",function(){var t,e=$(this).parents(".plan"),a=e.data("level"),i=e.data("rank");0!=(t=e.siblings().filter('[data-level="'+a+'"][data-rank="'+(i+1)+'"]')).length&&(e.removeClass("active"),t.addClass("active"))}).on("click",".plan > header .previous:not(.first)",function(){var t,e=$(this).parents(".plan"),a=e.data("level"),i=e.data("rank");0!=(t=e.siblings().filter('[data-level="'+a+'"][data-rank="'+(i-1)+'"]')).length&&(e.removeClass("active"),t.addClass("active"))}).children(".plan").each(function(){$(this).find(".title").append('<div class="next">Next</div><div class="previous">Previous</div>')})}};return c}(),app.init()},{breakpoints:"breakpoints",browser:"browser",form:"form",jquery:"jquery","jquery.touch":"jquery.touch",md5:"md5",tabs:"tabs",web:"web"}],formArray:[function(t,e,a){function i(t,e){var a,r=this;this.count=1e3,this.states=[],this.isDragging=!1,this.hasDropTarget=!1,this.id=t.attr("id"),t.removeAttr("id"),this.name=t.attr("name"),t.removeAttr("name"),this.title=t.data("title"),t.removeData("title").removeAttr("data-title"),this.thumbnail=t.data("thumbnail"),t.removeData("thumbnail").removeAttr("data-thumbnail"),a=t.data("value"),t.removeData("value").removeAttr("data-value"),this.form=e,this.min=t.data("min"),t.removeData("min").removeAttr("data-min"),this.max=t.data("max"),t.removeData("max").removeAttr("data-max"),this.collapse="1"==t.data("collapse"),t.removeData("collapse").removeAttr("collapse"),this.collapseAlt="1"==t.data("collapse-alt"),t.removeData("collapse-alt").removeAttr("collapse-alt"),this.collapseSingular="1"==t.data("collapse-singular"),t.removeData("collapse-singular").removeAttr("collapse-singular"),t.data("clone-fields")?(this.cloneFields=t.data("clone-fields").split(","),t.removeData("clone-fields").removeAttr("clone-fields")):this.cloneFields=null,this.exposeCount="1"==t.data("expose-count"),t.removeData("expose-count").removeAttr("expose-count"),this.lastAction={action:null},this.$template=$('<div class="item'+(this.thumbnail?" with-thumbnail":"")+'" tabindex="0"><div class="header">'+(this.thumbnail?'<div class="thumbnail '+this.thumbnail+'"></div>':"")+'<span class="title"></span><div class="actions"><div class="do-delete"><svg><use xlink:href="#icon-delete"></use></svg><span class="label">Delete</span></div></div></div><div class="inner"></div></div>'),t.children().appendTo(this.$template.children(".inner")),this.$template.find("input, textarea, select").prop("disabled",!1),this.$placeholder=$('<div class="placeholder" />'),this.$wrapper=t,this.$wrapper.attr("id",this.id).attr("name",this.name).on("input","input, textarea, select",function(t,e){t.stopPropagation()}).on("change","input, textarea, select",function(t,e){var a=$(this).attr("id");t.stopPropagation(),"formArray.val"!=e&&"init"!=e&&a!=r.id+"_count"&&r.change("formArray.change",a)}).on("blur","input, textarea, select",function(t){var e=$(this).attr("id");t.stopPropagation(),r.blur("formArray.blur",e)}).on("change.title",'[name^="'+this.title+'_"]',function(t){var e=$(this),a=e.parents(".item"),i=e.val();t.stopPropagation(),i?"SELECT"==this.tagName&&(i=e.find('option[value="'+i+'"]').text()):i="(untitled)",a.find(".header .title").text(i)}).on("click",".item .footer .do-delete",function(){var t=$(this).parents(".item");r.remove(r.itemIndex(t))}),this.thumbnail&&this.$wrapper.on("change.thumbnail",function(){var t;switch(r.thumbnail){case"asset":t='[name^="assetId_"]';break;case"icon":t='[name^="type_"]';break;case"buttonIcon":t='[name^="iconType_"]'}return t}(),function(t){var e,a,i,s=$(this).parents(".item");switch(t.stopPropagation(),e=s.find(".header .thumbnail"),r.thumbnail){case"asset":a=s.find('[name^="assetData_"]').val(),r.$wrapper.data("thumbnailDisabled")?e.addClass("is-disabled"):e.removeClass("is-disabled"),a?e.removeClass("is-unassigned").css("background-image",'url("'+a+'")'):e.addClass("is-unassigned").css("background-image","");break;case"icon":a=s.find('[name^="type_"]').val(),r.$wrapper.data("thumbnailDisabled")?e.addClass("is-disabled"):e.removeClass("is-disabled"),a?(i=app.build.icons.get(a),e.removeClass("is-unassigned").html('<svg><use xlink:href="'+(app.build.icons.inlined?"":app.build.icons.url)+"#icon-"+i.code+'"></use></svg>')):e.addClass("is-unassigned").html("");break;case"buttonIcon":a=s.find('[name^="iconType_"]').val(),r.$wrapper.data("thumbnailDisabled")?e.addClass("is-disabled"):e.removeClass("is-disabled"),a?(i=app.build.icons.get(a),e.removeClass("is-unassigned").html('<svg><use xlink:href="'+(app.build.icons.inlined?"":app.build.icons.url)+"#icon-"+i.code+'"></use></svg>')):e.addClass("is-unassigned").html("")}}),this.$items=$('<div class="items"></div>').appendTo(this.$wrapper).touch({useMouse:app.touch.useMouse,useTouch:app.touch.useTouch,dragThreshold:0,dragDelay:0,tapAndHoldDelay:300,trackDocument:!0,delegateSelector:".item, .item > .inner",dropFilter:".item",preventDefault:{drag:app.touch.dragPreventDefault}}).on("mousedown",".item",function(t){$(this).addClass("is-clicked")}).on("mousedown",".item > .inner",function(t){$(this).parent().addClass("is-clicked")}).on("blur",".item",function(t){t.target===this&&$(this).removeClass("is-clicked")}).on("click",".item",function(t){var e=$(t.target);0<e.length&&"A"==e[0].tagName&&"#"==e.attr("href").charAt(0)||t.stopPropagation()}).on("keydown",".item:focus",function(t){switch(t.keyCode){case 13:case 32:$(this).trigger("tap");break;default:return app.keyHandler.apply(this,[t])}}).on("tap dragStart tapAndHold",".item > .inner",function(t,e){t.stopPropagation()}).on("click",".do-delete",function(t,e){var a=$(this).parents(".item");t.stopPropagation(),r.remove(r.itemIndex(a))}).on("tap",".item",function(t,e){var a=$(this);t.stopPropagation(),r.toggle(r.itemIndex(a)),r.$items.trigger("click")}).on(app.touch.dragStartEvents,".item",function(t,e){var a=$(this),i=app.$document.scrollLeft(),s=app.$document.scrollTop(),o=a[0].getBoundingClientRect().width,n=a[0].getBoundingClientRect().height;t.stopPropagation(),r.isDragging=!0,r.$wrapper.addClass("is-dragging"),"android"==browser.os&&app.$body.css("overflow","hidden"),r.$placeholder.css("width",o+"px").css("height",n+"px").insertBefore(a),a.css("width",o+"px").css("height",n+"px").addClass("is-dragging").css("left",e.x-e.ex-i+"px").css("top",e.y-e.ey-s+"px")}).on("drag",".item",function(t,e){var a=$(this),i=app.$document.scrollLeft(),s=app.$document.scrollTop();a.hasClass("is-dragging")&&r.isDragging&&(t.stopPropagation(),a.css("left",e.x-e.start.ex-i+"px").css("top",e.y-e.start.ey-s+"px"))}).on("dragEnd tapAndHoldEnd",".item",function(t,e){var a=$(this);a.hasClass("is-dragging")&&r.isDragging&&(t.stopPropagation(),r.isDragging=!1,r.$wrapper.removeClass("is-dragging"),"android"==browser.os&&app.$body.css("overflow",""),r.$placeholder.detach().css("width","").css("height",""),a.removeClass("is-dragging").css("left","").css("top","").css("width","").css("height",""),r.hasDropTarget=!1,a.removeClass("is-dropTarget").removeClass("after").removeClass("before"))}).on("dragEnter",".item",function(t,e){var a=$(this),i=$(e.element);a.hasClass("is-dragging")&&r.isDragging&&(t.stopPropagation(),r.hasDropTarget=!0,i.add(i.siblings()).removeClass("is-dropTarget").removeClass("after").removeClass("before"),i.addClass("is-dropTarget"))}).on("dragOver",".item",function(t,e){var a=$(this),i=$(e.element);a.hasClass("is-dragging")&&r.isDragging&&(t.stopPropagation(),e.ey<Math.ceil(i.outerHeight()/2)?i.addClass("before").removeClass("after"):i.addClass("after").removeClass("before"))}).on("dragLeave",".item",function(t,e){var a=$(this),i=$(e.element);a.hasClass("is-dragging")&&r.isDragging&&(t.stopPropagation(),r.hasDropTarget=!1,i.removeClass("is-dropTarget"))}).on("drop",".item",function(t,e){var a,i=$(this),s=$(e.element);i.hasClass("is-dragging")&&r.isDragging&&r.hasDropTarget&&(t.stopPropagation(),r.hasDropTarget=!1,a=s.hasClass("after")?1:-1,s.removeClass("is-dropTarget").removeClass("after").removeClass("before"),r.move(i,s,a))}),this.$footer=$('<div class="footer"><ul class="actions fit"><li><span class="button do-add" tabindex="0">Add</span></li></ul></div>').appendTo(this.$wrapper),this.$footer.on("click",".do-add",function(t,e){t.preventDefault(),$(this).blur(),r.add(e)}).on("keydown",".do-add",function(t){switch(t.keyCode){case 13:$(this).trigger("click",[!0]);break;default:return app.keyHandler.apply(this,[t])}}).on("click",".do-dump",function(t){t.stopPropagation(),t.preventDefault()}),this.exposeCount?this.$count=$('<input type="hidden" name="'+this.id+'_count" id="'+this.id+'_count" value="0" />').appendTo(this.$wrapper):this.$count=null,this.sync(),a&&this.val("object"==typeof a?a:JSON.parse(a))}i.prototype.itemIndex=function(t){return this.$wrapper.find(".item").index(t)},i.prototype.get=function(t){return this.$item.eq(t)},i.prototype.length=function(){return this.$items.children(".item").length},i.prototype.toggle=function(t){!0===this.states[t]?(this.get(t).removeClass("collapsed").find("textarea[data-autosize]").triggerHandler("--refresh-input"),this.states[t]=!1,this.collapseSingular&&this.collapseAll(t)):(this.get(t).addClass("collapsed"),this.states[t]=!0)},i.prototype.collapseAll=function(t){var e=0,a=this.length();for(e=0;e<a;e++)void 0!==t&&e==t||(this.get(e).addClass("collapsed"),this.states[e]=!0)},i.prototype.move=function(t,e,a){var i,s,o,n;if(!((o="object"==typeof t?(i=t,this.itemIndex(t)):(i=this.get(t),t))==(n="object"==typeof e?(s=e,this.itemIndex(e)):(s=this.get(e),e))||n<0||n>=this.length())){1==a?i.insertAfter(s):i.insertBefore(s);t=this.states[n];this.states[n]=this.states[o],this.states[o]=t,this.lastAction={action:"move",src:o,dest:n,pos:a},this.sync(),this.change("formArray.move")}},i.prototype.remove=function(t){this.removeBase(t)&&(this.lastAction={action:"remove",index:t},this.sync(),this.change("formArray.remove"))},i.prototype.removeBase=function(t){return!(this.length()<=this.min)&&(this.get(t).remove(),this.states.splice(t,1),!0)},i.prototype.add=function(t){var e;this.collapseSingular&&this.collapseAll(),(e=this.addBase())&&(this.form.initTypes(e),this.form.initRequires(e,this.form.$obj),this.form.initConditions(e,this.form.$obj),this.lastAction={action:"add",$item:e},this.sync(),this.change("formArray.add"),t&&e.focus())},i.prototype.addBase=function(){var o=this.$template.clone(!0),n=this.count++;if(!(0<this.max&&this.length()>=this.max)){var t,e,a,i;if(o.data("id",n),this.$wrapper.attr("tabindex")&&o.data("tabindex","0").attr("tabindex",this.$wrapper.attr("tabindex")),o.find("input, textarea, select").each(function(){var t=$(this),e=t.attr("type"),a=(t.parents(".field").first(),t.attr("id")),i=t.attr("name"),s=o.find('label[for="'+a+'"]');t.attr("id",a.replace("_xxx","_"+n)).attr("name",i.replace("_xxx","_"+n)),0<s.length&&s.attr("for",a.replace("_xxx","_"+n)),"checkbox"!=e&&"radio"!=e&&s.on("click",function(t){t.preventDefault()}),t.val(t.attr("value"))}),o.find("[data-requires]").each(function(){var t=$(this),e=t.attr("data-requires");e&&t.attr("data-requires",e.replace("_xxx","_"+n))}),this.cloneFields&&0<this.length())for(i in t=this.$item.last(),this.cloneFields)a=this.cloneFields[i],e=t.find('[name^="'+a+'_"]').first(),o.find('[name^="'+a+'_"]').first().val(e.val());return o.appendTo(this.$items),o}},i.prototype.val=function(t){if(t){var e,a,i,s,o,n,r=Math.max(t.length,this.min),l=this.length();if(0==r)this.$item.remove();else if(l<r){for(e=l;e<r;e++)this.addBase();this.$item=this.$items.children(".item")}else if(r<l){for(e=l;r<e;e--)this.removeBase(e-1);this.$item=this.$items.children(".item")}if(0<r)for(e in this.$items.find("input, textarea, select").val(""),t){for(a in s=(o=this.get(e)).data("id"),t[e])if("object"==typeof t[e][a])for(i in t[e][a])"checkbox"==(n=o.find('[name="'+a+"."+i+"_"+s+'"]')).attr("type")?n.prop("checked",t[e][a][i]):n.val(t[e][a][i]);else"checkbox"==(n=o.find('[name="'+a+"_"+s+'"]')).attr("type")?n.prop("checked",t[e][a]):n.val(t[e][a]),n.trigger("change",["formArray.val"]);e in this.states?!1===this.states[e]?o.removeClass("collapsed"):o.addClass("collapsed"):this.collapse&&(!this.collapseAlt||0<e)?o.addClass("collapsed"):o.removeClass("collapsed"),this.form.initTypes(o),this.form.initRequires(o,this.form.$obj),this.form.initConditions(o,this.form.$obj)}return this.sync(),this.$wrapper}var c=[];return this.$item.each(function(){var t=$(this),i={};t.find("input, textarea, select").each(function(){var t=$(this),e=t.attr("name").replace(/_[0-9]+$/,"").split("."),a=t.val();"checkbox"==t.attr("type")&&(a=!!t.prop("checked")),2==e.length?(e[0]in i||(i[e[0]]={}),i[e[0]][e[1]]=a):i[e[0]]=a}),c.push(i)}),c},i.prototype.change=function(t,e){this.$wrapper.trigger("change",[t,e])},i.prototype.blur=function(t,e){this.$wrapper.trigger("blur",[t,e])},i.prototype.sync=function(){var t=this,e=this.length();if(this.$item=this.$items.children(".item"),0==e)this.$wrapper.addClass("empty");else switch(this.$wrapper.removeClass("empty"),0<this.min&&e<=this.min?this.$wrapper.addClass("is-min"):this.$wrapper.removeClass("is-min"),this.$items.find('[name^="'+this.title+'_"]').trigger("change.title",["formArray.sync"]),this.thumbnail){case"asset":this.$items.find('[name^="assetId_"]').trigger("change.thumbnail",["formArray.sync.asset"]);break;case"icon":this.$items.find('[name^="type_"]').trigger("change.thumbnail",["formArray.sync.icon"]);break;case"buttonIcon":this.$items.find('[name^="iconType_"]').trigger("change.thumbnail",["formArray.sync.thumbnail"])}this.states=[],this.$item.each(function(){t.states.push($(this).hasClass("collapsed"))}),this.exposeCount&&this.$count.val(e).attr("value",e).trigger("change",["formArray.sync"])},i.prototype.dump=function(){},i.prototype.scrollTop=function(){return $(window).scrollTop()},$.fn.formArray=function(t){var e=$(this);if(0==this.length)return e;if(1<this.length){for(var a=0;a<this.length;a++)$(this[a]).formArray(t);return e}return this[0]._formArray=new i(e,t),e},$.valHandlers.push({condition:function(){return"_formArray"in this},get:function(){return this._formArray.val()},set:function(t){return this._formArray.val(t)}}),e.exports=i},{}],formColorPicker:[function(t,e,a){function i(t){var n,e,a,i,r,l,c,h,p,d=this;this.alpha="1"==t.data("alpha"),t.removeData("alpha").removeAttr("data-alpha"),this.optional="1"==t.data("optional"),this.optional&&t.attr("placeholder","(none)"),this.expand=t.hasClass("left")||t.hasClass("right"),t.attr("type","text").attr("data-manual","1").data("manual","1").attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false").attr("maxlength",this.alpha?9:7).on("focus",function(){if(n.addClass("focus"),d.expand){var t=n.parent(),e=t.parent();"static"==e.css("position")&&e.css("position","relative"),n.addClass("expand").css("width",e.width()).css("left",-1*t.position().left+"px"),e.css("position","")}}).on("blur",function(){n.removeClass("focus"),d.expand&&n.removeClass("expand").css("width","").css("left","")}),l={$input:null,$swatch:null,currentValue:"#FFFFFF",init:function(t){var n=this;this.$input=t,d.optional&&(this.currentValue=""),this.$swatch=$('<div class="swatch" />').insertBefore(this.$input),this.$input.on("change input",function(t,e,a){if(!a){var i,s,o=n.$input.val();if(""==o&&d.optional)r=!0,h.pos=0,c.pos[0]=100,c.pos[1]=0,d.alpha&&(p.pos=100);else{if(r=!1,!(i=d.hexaToRgba(o)))return;l.currentValue=o.toUpperCase(),s=d.rgbaToHsva(i.r,i.g,i.b,i.a),h.pos=100*s.h,c.pos[0]=100*s.s,c.pos[1]=100*(1-s.v),d.alpha?p.pos=100*s.a:p.pos=0}d.alpha&&p.sync(),h.sync(),c.sync(),n.sync(e,a)}}).on("blur",function(){n.$input.val(l.currentValue)})},sync:function(t,e){if(r)return n.addClass("empty"),this.$swatch.css("background-color",""),l.currentValue="",this.$input.val("").trigger("change",[t,!0]),void c.redraw();n.removeClass("empty"),h.changed()&&c.redraw();var a={h:null,s:null,v:null,a:null};a.h=h.pos/100,a.s=c.pos[0]/100,a.v=1-c.pos[1]/100,d.alpha?a.a=p.pos/100:a.a=1;var i=d.hsvaToRgba(a.h,a.s,a.v,a.a),s=d.rgbaToHexa(i.r,i.g,i.b,i.a),o="rgba("+i.r+","+i.g+","+i.b+","+i.a/255+")";this.$swatch.css("background-color",o),l.currentValue=s,this.$input.val()!=s&&this.$input.val(s).trigger("change",[t,!0])}},n=$('<div class="form-color-picker '+(t.attr("class")?t.attr("class"):"")+'"><div class="content"><div class="inner"><div class="hueSlider"><div class="cursor"></div><canvas></canvas></div><div class="picker"><div class="cursor"></div><canvas></canvas></div>'+(d.alpha?'<div class="alphaSlider"><div class="cursor"></div><canvas></canvas></div>':"")+"</div></div></div>").insertAfter(t),t.prependTo(n),n.find(".content").on("mousedown touchstart",function(t){t.preventDefault(),t.stopPropagation()}),e=n.find(".picker"),c={$cursor:null,$wrapper:null,$canvas:null,canvas:null,context:null,imageData:null,pos:[0,0],dragTimeoutId:null,sync:function(){this.$cursor.css("left",this.pos[0]+"%").css("top",this.pos[1]+"%")},init:function(t){var a=this;this.$wrapper=t,this.$canvas=this.$wrapper.find("canvas").css("position","absolute").css("top",0).css("left",0).css("width","100%").css("height","100%").css("cursor","crosshair"),this.canvas=this.$canvas[0],this.canvas.width=100,this.canvas.height=100,this.context=this.canvas.getContext("2d"),this.imageData=this.context.getImageData(0,0,100,100),this.$cursor=this.$wrapper.find(".cursor"),this.$canvas.touch({useMouse:app.touch.useMouse,useTouch:app.touch.useTouch,trackDocument:!0,trackDocumentNormalize:!0,dragThreshold:0,dragDelay:0,preventDefault:{drag:!0}}).on("tap dragStart drag",function(t,e){a.pos[0]=Math.round(e.ex/a.$canvas.width()*100),a.pos[1]=Math.round(e.ey/a.$canvas.height()*100),r=!1,clearTimeout(a.dragTimeoutId),a.dragTimeoutId=setTimeout(function(){a.sync(),l.sync()},1)}),this.redraw()},redraw:function(){var t,e,a,i,s,o;for(t=0;t<100;t++)for(e=0;e<100;e++)a=e,i=99-t,o=d.hsvaToRgba(h.pos/100,e/100,t/100,1),s=4*(a+100*i),this.imageData.data[0+s]=o.r,this.imageData.data[1+s]=o.g,this.imageData.data[2+s]=o.b,this.imageData.data[3+s]=255;this.context.putImageData(this.imageData,0,0),this.sync()}},a=n.find(".hueSlider"),h={$cursor:null,$wrapper:null,$canvas:null,canvas:null,context:null,imageData:null,pos:0,lastPos:0,dragTimeoutId:null,changed:function(){return this.pos!=this.lastPos},sync:function(){this.$cursor.css("top",this.pos+"%")},init:function(t){var a=this;this.$wrapper=t,this.$canvas=this.$wrapper.find("canvas").css("position","absolute").css("top",0).css("left",0).css("width","100%").css("height","100%").css("cursor","crosshair").appendTo(this.$wrapper),this.canvas=this.$canvas[0],this.canvas.width=1,this.canvas.height=100,this.context=this.canvas.getContext("2d"),this.imageData=this.context.getImageData(0,0,1,100),this.$cursor=this.$wrapper.find(".cursor"),this.$canvas.touch({useMouse:app.touch.useMouse,useTouch:app.touch.useTouch,trackDocument:!0,trackDocumentNormalize:!0,dragThreshold:0,dragDelay:0,preventDefault:{drag:!0}}).on("tap dragStart drag",function(t,e){a.lastPos=a.pos,a.pos=Math.round(e.ey/a.$canvas.height()*100),r=!1,clearTimeout(a.dragTimeoutId),a.dragTimeoutId=setTimeout(function(){a.sync(),l.sync()},1)}).on("dragEnd",function(t,e){a.lastPos=a.pos,a.pos=Math.round(e.end.ey/a.$canvas.height()*100),(100<a.pos||a.pos<0)&&(a.pos=Math.max(0,Math.min(100,a.lastPos))),r=!1,a.sync(),l.sync(),c.redraw()}),this.redraw()},redraw:function(){var t,e,a,i,s;for(t=0;t<100;t++)for(s=d.hsvaToRgba(t/100,1,1,1),a=t,e=0;e<1;e++)i=4*(e+1*a),this.imageData.data[0+i]=s.r,this.imageData.data[1+i]=s.g,this.imageData.data[2+i]=s.b,this.imageData.data[3+i]=s.a;this.context.putImageData(this.imageData,0,0),this.sync(),this.lastPos=this.pos}},i=n.find(".alphaSlider"),p={$cursor:null,$wrapper:null,$canvas:null,canvas:null,context:null,imageData:null,pos:0,lastPos:0,dragTimeoutId:null,changed:function(){return this.pos!=this.lastPos},sync:function(){this.$cursor.css("left",this.pos+"%")},init:function(t){var a=this;this.$wrapper=t,this.$canvas=this.$wrapper.find("canvas").css("position","absolute").css("top",0).css("left",0).css("width","100%").css("height","100%").css("cursor","crosshair").appendTo(this.$wrapper),this.canvas=this.$canvas[0],this.canvas.width=100,this.canvas.height=1,this.context=this.canvas.getContext("2d"),this.imageData=this.context.getImageData(0,0,100,1),this.$cursor=this.$wrapper.find(".cursor"),this.$canvas.touch({useMouse:app.touch.useMouse,useTouch:app.touch.useTouch,trackDocument:!0,trackDocumentNormalize:!0,dragThreshold:0,dragDelay:0,preventDefault:{drag:!0}}).on("tap dragStart drag",function(t,e){a.lastPos=a.pos,a.pos=Math.round(e.ex/a.$canvas.width()*100),r=!1,clearTimeout(a.dragTimeoutId),a.dragTimeoutId=setTimeout(function(){a.sync(),l.sync()},1)}),this.redraw()},redraw:function(){var t,e,a,i;for(t=0;t<100;t++)for(a=t,e=0;e<1;e++)i=4*(e+1*a),this.imageData.data[0+i]=255,this.imageData.data[1+i]=255,this.imageData.data[2+i]=255,this.imageData.data[3+i]=a/100*255;this.context.putImageData(this.imageData,0,0),this.sync(),this.lastPos=this.pos}},l.init(t),c.init(e),h.init(a),this.alpha&&p.init(i),t.triggerHandler("change",["init",!1])}i.prototype.rgbaToHsva=function(t,e,a,i){var s,o=Math.max(t,e,a),n=Math.min(t,e,a),r=o-n,l=0===o?0:r/o,c=o/255;i/=255;switch(o){case n:s=0;break;case t:s=e-a+r*(e<a?6:0),s/=6*r;break;case e:s=a-t+2*r,s/=6*r;break;case a:s=t-e+4*r,s/=6*r}return{h:s,s:l,v:c,a:i}},i.prototype.hexaToRgba=function(t){var e,a,i,s=255;if("#"!=t.charAt(0))return null;if(6==(t=t.substr(1)).length){if(e=parseInt(t.substr(0,2),16),a=parseInt(t.substr(2,2),16),i=parseInt(t.substr(4,2),16),isNaN(e)||isNaN(a)||isNaN(i))return null}else{if(8!=t.length||!this.alpha)return null;if(e=parseInt(t.substr(0,2),16),a=parseInt(t.substr(2,2),16),i=parseInt(t.substr(4,2),16),s=parseInt(t.substr(6,2),16),isNaN(e)||isNaN(a)||isNaN(i)||isNaN(s))return null}return{r:e,g:a,b:i,a:s}},i.prototype.rgbaToHexa=function(t,e,a,i){var s,o,n,r;return s=t.toString(16),o=e.toString(16),n=a.toString(16),r=i.toString(16),1==s.length&&(s="0"+s),1==o.length&&(o="0"+o),1==n.length&&(n="0"+n),1==r.length&&(r="0"+r),this.alpha&&"ff"!=r||(r=""),"#"+(s+o+n+r).toUpperCase()},i.prototype.hsvaToRgba=function(t,e,a,i){var s,o,n,r,l,c,h,p;switch(c=a*(1-e),h=a*(1-(l=6*t-(r=Math.floor(6*t)))*e),p=a*(1-(1-l)*e),r%6){case 0:s=a,o=p,n=c;break;case 1:s=h,o=a,n=c;break;case 2:s=c,o=a,n=p;break;case 3:s=c,o=h,n=a;break;case 4:s=p,o=c,n=a;break;case 5:s=a,o=c,n=h}return{r:Math.round(255*s),g:Math.round(255*o),b:Math.round(255*n),a:Math.round(255*i)}},$.fn.formColorPicker=function(){var t=$(this);if(0==this.length)return t;if(1<this.length){for(var e=0;e<this.length;e++)$(this[e]).formColorPicker();return t}return"_formColorPicker"in this[0]||(this[0]._formColorPicker=new i(t)),t},void 0!==e&&(e.exports=i)},{}],formImageUploader:[function(t,e,a){function i(t){var e;this.$obj=t,this.inputPrefix="",this.image={canvas:null,width:0,height:0,type:null,size:0,orientation:null,animated:!1,editable:!1,original:null,adjustments:{},crop:{topLeft:{x:null,y:null},bottomRight:{x:null,y:null}}},this.settings={mode:"data",editable:!0,forceCropMode:null,maxCanvasWH:2560,maxWH:1024,maxSize:2048,forceCanvas:!1,forceType:!1,circle:!1,minWidth:150,minHeight:150,inArray:!1},void 0!==(e=this.$obj.attr("data-mode"))&&(this.settings.mode=e),void 0!==(e=this.$obj.attr("data-editable"))&&(this.settings.editable="1"==e),void 0!==(e=this.$obj.attr("data-maxWH"))&&(this.settings.maxWH=parseInt(e),this.settings.maxCanvasWH=2.5*this.settings.maxWH),void 0!==(e=this.$obj.attr("data-maxCanvasWH"))&&(this.settings.maxCanvasWH=parseInt(e)),void 0!==(e=this.$obj.attr("data-maxSize"))&&(this.settings.maxSize=parseInt(e)),void 0!==(e=this.$obj.attr("data-forceCanvas"))&&(this.settings.forceCanvas="1"==e),void 0!==(e=this.$obj.attr("data-forceType"))&&(this.settings.forceType=e),void 0!==(e=this.$obj.attr("data-forceCropMode"))&&(this.settings.forceCropMode=e),void 0!==(e=this.$obj.attr("data-circle"))&&(this.settings.circle="1"==e),void 0!==(e=this.$obj.attr("data-minWidth"))&&(this.settings.minWidth=parseInt(e)),void 0!==(e=this.$obj.attr("data-minHeight"))&&(this.settings.minHeight=parseInt(e)),void 0!==(e=this.$obj.attr("data-inArray"))&&(this.settings.inArray="1"==e),this.init()}i.prototype.init=function(){var a=this;this.$image=$("<img />").on("load",function(){a.completeLoad()}),this.image.canvas=document.createElement("canvas"),this.$idInput=this.$obj.find(".id").css("position","absolute").css("width","0px").css("height","0px").css("visibility","hidden").css("z-index","-1").css("overflow","hidden").css("-moz-pointer-events","none").css("-webkit-pointer-events","none").css("-ms-pointer-events","none").css("pointer-events","none").on("--refresh-image",function(){var t,e;t=a.$dataInput.val(),e=a.$idInput.val(),t&&e?(a.$thumbnail.css("background-image","url("+t+")"),a.$obj.removeClass("new")):(a.$thumbnail.css("background-image",""),a.$obj.addClass("new"))}),this.$dataInput=this.$obj.find(".data").css("display","none"),this.$fileInput=$('<input type="file" name="image" autocomplete="off" accept="image/jpeg,image/gif,image/png,image/svg+xml" />').on("change",function(){a.load(a.$fileInput.prop("files")[0]),a.$fileInput.val("")}),this.$thumbnail=$('<div class="thumbnail"></div>').prependTo(this.$obj).css("background-size","cover").css("background-position","center").on("click",function(t){t.preventDefault(),t.stopPropagation(),a.$idInput.prop("disabled")||a.$fileInput.trigger("click")}),this.$obj.on("click",".do-upload",function(t){t.preventDefault(),t.stopPropagation(),a.$idInput.prop("disabled")||a.$fileInput.trigger("click")}).on("keydown",".do-upload",app.keyHandler).on("dragover",function(t){return a.$obj.addClass("is-dragOver"),!1}).on("drop dragleave",function(t){return a.$obj.removeClass("is-dragOver"),!1}).on("drop",function(t){var e=t.originalEvent.dataTransfer.files;e.length;return a.load(e[0]),a.$fileInput.val(""),!1}),this.$obj.on("click",".do-clear",function(t){var e;t.preventDefault(),t.stopPropagation(),a.$idInput.prop("disabled")||(a.$image.attr("src",""),a.$thumbnail.css("background-image",""),e=a.$dataInput.val(),"object"==a.settings.mode&&e&&app.objectUrl.is(e)&&app.objectUrl.revoke(e),a.$dataInput.val("").trigger(a.settings.inArray?"change-in-array":"change"),a.$idInput.val("").trigger("change",["formImageUploader.clear"]),a.$obj.addClass("new"),a.settings.inArray&&a.$obj.parents(".form-array").first().trigger("arrayChange"))}).on("keydown",".do-clear",app.keyHandler),this.$idInput.triggerHandler("--refresh-image"),h.init()},i.prototype.sync=function(e){function a(){(t=u.image.canvas.getContext("2d")).clearRect(0,0,u.image.canvas.width,u.image.canvas.height),u.$thumbnail.css("background-image","url("+e+")"),d=u.$dataInput.val(),"object"==u.settings.mode&&d&&app.objectUrl.is(d)&&app.objectUrl.revoke(d),u.$dataInput.val(e).trigger(u.settings.inArray?"change-in-array":"change"),u.$idInput.val(md5(String(Date.now())+e)).trigger("change",["formImageUploader.sync"]),u.$obj.removeClass("new"),u.image.animated=!1,u.image.editable=!1,u.settings.inArray&&u.$obj.parents(".form-array").first().trigger("arrayChange")}var i,t,s,o,n,r,l,c,h,p,d,u=this;if(void 0===e){if(i=document.createElement("canvas"),t=i.getContext("2d"),i.width=this.image.crop.bottomRight.x-this.image.crop.topLeft.x,i.height=this.image.crop.bottomRight.y-this.image.crop.topLeft.y,t.drawImage(this.image.canvas,-1*this.image.crop.topLeft.x,-1*this.image.crop.topLeft.y),(i.width>this.settings.maxWH||i.height>this.settings.maxWH)&&(r=this.settings.maxWH/i.width,l=this.settings.maxWH/i.height,c=Math.min(r,l),h=Math.floor(c*i.width),p=Math.floor(c*i.height),n=(o=document.createElement("canvas")).getContext("2d"),o.width=h,o.height=p,n.drawImage(i,0,0,h,p),delete i,i=o),"image/png"==this.image.type){for(var g=t.getImageData(0,0,i.width,i.height).data,f=!1,m=0;m<g.length;m+=4)if(g[m+3]<255){f=!0;break}f||(this.image.type="image/jpeg")}if(this.settings.forceType)s=this.settings.forceType;else switch(this.image.type){case"image/svg+xml":s="image/svg+xml";break;case"image/png":case"image/gif":s="image/png";break;default:s="image/jpeg"}switch(this.settings.mode){case"object":case"object-manual":i.toBlob(function(t){e=app.objectUrl.create(t),delete i,a()},s,1);break;default:case"data":e=i.toDataURL(s,1),delete i,a()}}else a()},i.prototype.load=function(a){var i=this;a&&this.getImageProperties(a,function(t){var e;switch(i.image.type=t.type,i.image.size=t.size,i.image.orientation=t.orientation,i.image.animated=t.animated,i.image.type){case"image/svg+xml":i.image.editable=!1;break;case"image/jpeg":case"image/png":i.image.editable=!0;break;case"image/gif":i.image.animated&&!i.settings.forceCanvas?i.image.editable=!1:i.image.editable=!0;break;default:return void app.dialog.show({title:"Invalid image type",message:"Sorry, images must be in either JPEG, PNG, GIF, or SVG format."})}Math.floor(i.image.size/1024)>i.settings.maxSize?app.dialog.show({title:"Image too large",message:"Sorry, images cannot exceed "+i.settings.maxSize/1024+"MB in file size."}):(e=app.objectUrl.create(a),i.$image.css("width","").css("height","").attr("src","").attr("src",e))})},i.prototype.completeLoad=function(){var t,e,a,i,s,o,n,r=this,l=0,c=!1;if(this.image.editable||this.settings.forceCanvas){switch(this.image.orientation){case 1:default:break;case 2:c=!0;break;case 3:l=180;break;case 4:c=!0,l=180;break;case 5:c=!0,l=270;break;case 6:l=90;break;case 7:c=!0,l=90;break;case 8:l=-90}if(a=this.$image[0].width,i=this.$image[0].height,(a>this.settings.maxCanvasWH||i>this.settings.maxCanvasWH)&&(s=this.settings.maxCanvasWH/a,o=this.settings.maxCanvasWH/i,n=Math.min(s,o),a=Math.floor(n*a),i=Math.floor(n*i)),t=this.image.canvas.getContext("2d"),360<=l?l-=360:l<0&&(l+=360),0==l||180==Math.abs(l)?(this.image.canvas.width=a,this.image.canvas.height=i,t.translate(this.image.canvas.width/2,this.image.canvas.height/2),t.rotate(l*(Math.PI/180)),t.translate(this.image.canvas.width/-2,this.image.canvas.height/-2)):(this.image.canvas.width=i,this.image.canvas.height=a,t.translate(this.image.canvas.width/2,this.image.canvas.height/2),t.rotate(l*(Math.PI/180)),t.translate(this.image.canvas.height/-2,this.image.canvas.width/-2)),c?(t.scale(-1,1),t.drawImage(this.$image[0],-a,0,a,i)):t.drawImage(this.$image[0],0,0,a,i),this.image.width=this.image.canvas.width,this.image.height=this.image.canvas.height,(e=this.$image.attr("src"))&&app.objectUrl.is(e)&&app.objectUrl.revoke(e),this.$image.attr("src",""),!this.settings.editable)return this.image.crop.topLeft.x=0,this.image.crop.topLeft.y=0,this.image.crop.bottomRight.x=this.image.width,this.image.crop.bottomRight.y=this.image.height,this.sync(),void(this.image.orientation=null);h.show(this),window._formImageUploader=this}else switch(e=this.$image.attr("src"),r.settings.mode){case"object":case"object-manual":e&&app.objectUrl.is(e)?this.sync(e):app.objectUrl.createFromUrl(e,function(t){r.sync(t)});break;default:case"data":e&&app.dataUrl.is(e)&&this.sync(e),app.dataUrl.createFromUrl(e,function(t){r.sync(t)})}},i.prototype.getImageProperties_orientation=function(t){var e,a,i,s,o,n,r;if(65496!=(e=new DataView(t)).getUint16(0,!1))return null;for(a=Math.min(e.byteLength,65536),i=2;i<a;)if(s=e.getUint16(i,!1),i+=2,65505==s){if(1165519206!=e.getUint32(i+=2,!1))return null;for(o=18761==e.getUint16(i+=6,!1),i+=e.getUint32(i+4,o),n=e.getUint16(i,o),i+=2,r=0;r<n;r++)if(274==e.getUint16(i+12*r,o))return e.getUint16(i+12*r+8,o)}else{if(65280!=(65280&s))break;i+=e.getUint16(i,!1)}return null},i.prototype.getImageProperties_animated=function(t){var e,a,i,s,o,n;if(o=0,s=(e=new DataView(t)).byteLength,71!==e.getUint8(0)||73!==e.getUint8(1)||70!==e.getUint8(2)||56!==e.getUint8(3))return!1;for(a=0,i=s-3;a<i&&o<2;++a)0==e.getUint8(a)&&33===e.getUint8(a+1)&&249===e.getUint8(a+2)&&(n=a+4+e.getUint8(a+3))+1<s&&0===e.getUint8(n)&&(44===e.getUint8(n+1)||e.getUint8(n+1===33))&&o++;return 1<o},i.prototype.getImageProperties=function(a,i){var s=this,t=new FileReader;t.onload=function(t){var e={};e.type=a.type,e.size=a.size,e.orientation=s.getImageProperties_orientation(t.target.result),e.animated=s.getImageProperties_animated(t.target.result),i(e)},t.readAsArrayBuffer(a)};var h={instance:null,$window:null,$body:null,$modal:null,$canvas:null,image:null,settings:null,canvasWrapper:{width:0,height:0,zoom:1},crop:{mode:null,maskCanvas:null,controlSize:60,minWidth:150,minHeight:150,topLeft:null,bottomRight:null,width:function(){return this.bottomRight.x-this.topLeft.x},height:function(){return this.bottomRight.y-this.topLeft.y}},init:function(){var s=this;this.$modal||(this.$body=$("body"),this.$window=$(window).on("resize orientationchange",function(){s.isVisible()&&s.rescale()}),this.$modal=$('<div class="form-image-uploader-modal" tabindex="-1"><div class="inner"><div class="wrapper"><div class="canvas-wrapper"><canvas class="crop-mask" /><div class="crop"><div class="controls" data-control="move"><div class="control top-left" data-control="topLeft"></div><div class="control top-right" data-control="topRight"></div><div class="control bottom-right" data-control="bottomRight"></div><div class="control bottom-left" data-control="bottomLeft"></div><div class="control top" data-control="top"></div><div class="control right" data-control="right"></div><div class="control bottom" data-control="bottom"></div><div class="control left" data-control="left"></div></div></div></div></div><header><div class="menu"><div data-name="crop" data-tooltip="Crop" data-tooltip-mode="form-image-uploader-option"><svg><use xlink:href="#icon-expand"></use></svg></div><div data-name="rotate" data-tooltip="Rotate" data-tooltip-mode="form-image-uploader-option"><svg><use xlink:href="#icon-redo"></use></svg></div><div data-name="flip-horizontally" data-tooltip="Flip Horizontally" data-tooltip-mode="form-image-uploader-option"><svg><use xlink:href="#icon-transfer"></use></svg></div><div data-name="flip-vertically" data-tooltip="Flip Vertically" data-tooltip-mode="form-image-uploader-option"><svg><use xlink:href="#icon-sort"></use></svg></div><div data-name="adjustments" data-tooltip="Adjustments" data-tooltip-mode="form-image-uploader-option"><span><svg><use xlink:href="#icon-adjustments"></use></svg></span></div><div data-name="effects" data-tooltip="Effects" data-tooltip-mode="form-image-uploader-option"><span><svg><use xlink:href="#icon-effects"></use></svg></span></div></div><ul class="actions fixed"><li><a href="#" class="button small do-cancel"><span class="label">Cancel</span></a></li><li><a href="#" class="button small special do-save"><span class="label">Accept</span></a></li></ul></header><footer><section data-name="adjustments"><div class="field"><label>Hue</label><input type="range" class="xsmall" name="hue" min="0" max="360" step="1" value="0" data-default="0" /><div class="reset disabled"></div></div><div class="field"><label>Saturation</label><input type="range" class="xsmall" name="saturation" min="0" max="200" step="1" value="100" data-default="100"/><div class="reset disabled"></div></div><div class="field"><label>Brightness</label><input type="range" class="xsmall" name="brightness" min="0" max="200" step="1" value="100" data-default="100" /><div class="reset disabled"></div></div><div class="field"><label>Contrast</label><input type="range" class="xsmall" name="contrast" min="0" max="200" step="1" value="100" data-default="100" /><div class="reset disabled"></div></div></section><section data-name="effects"><div class="field"><label>Sepia</label><input type="range" class="xsmall" name="sepia" min="0" max="100" step="1" value="0" data-default="0" /><div class="reset disabled"></div></div><div class="field"><label>Black and White</label><input type="range" class="xsmall" name="grayscale" min="0" max="100" step="1" value="0" data-default="0" /><div class="reset disabled"></div></div><div class="field"><label>Invert</label><input type="range" class="xsmall" name="invert" min="0" max="100" step="1" value="0" data-default="0" /><div class="reset disabled"></div></div><div class="field"><label>Blur</label><input type="range" class="xsmall" name="blur" min="0" max="100" step="1" value="0" data-default="0" /><div class="reset disabled"></div></div></section></footer></div></div>').appendTo(this.$body).css("-moz-user-select","none").css("-webkit-user-select","none").css("-ms-user-select","none").css("user-select","none").on("click mousedown",function(t){t.stopPropagation()}).on("keydown",function(t){var e,a,i;switch(t.keyCode){case 13:t.preventDefault(),t.stopPropagation(),s.hide(!0);break;case 27:t.preventDefault(),t.stopPropagation(),s.hide();break;case 37:case 38:case 39:case 40:switch(t.preventDefault(),t.stopPropagation(),i=t.shiftKey?20:2,a=e=0,t.keyCode){case 37:e=-1*i;break;case 38:a=-1*i;break;case 39:e=i;break;case 40:a=i}s.cropControl_move(e,a),s.redrawCrop()}}),this.$wrapper=this.$modal.find(".wrapper"),this.$canvasWrapper=this.$modal.find(".canvas-wrapper").css("position","relative").css("max-width","100%"),this.$crop=this.$canvasWrapper.find(".crop").css("position","absolute").css("z-index",1).css("left",0).css("top",0),this.$cropMask=this.$canvasWrapper.find("canvas.crop-mask"),this.crop.maskCanvas=this.$cropMask[0],this.$cropControls=this.$crop.find(".controls").css("position","absolute").css("top",0).css("left",0).css("width","100%").css("height","100%"),x=.5*this.crop.controlSize*-1,this.$cropControls.find(".control").css("position","absolute").css("width",this.crop.controlSize+"px").css("height",this.crop.controlSize+"px"),this.$cropControls.find(".top-left").css("top",x).css("left",x),this.$cropControls.find(".top-right").css("top",x).css("right",x),this.$cropControls.find(".bottom-right").css("bottom",x).css("right",x),this.$cropControls.find(".bottom-left").css("bottom",x).css("left",x),this.$cropControls.find(".top").css("top",x).css("left","calc(50% + "+x+"px)"),this.$cropControls.find(".right").css("top","calc(50% + "+x+"px)").css("right",x),this.$cropControls.find(".bottom").css("bottom",x).css("left","calc(50% + "+x+"px)"),this.$cropControls.find(".left").css("top","calc(50% + "+x+"px)").css("left",x),this.$header=this.$modal.find("header"),this.$headerMenu=this.$header.find(".menu").on("click","div",function(t){var e=$(this).data("name");switch($(this).addClass("clicked"),e){case"crop":if(s.settings.forceCropMode)return;s.cycleCropMode();break;case"rotate":s.rotateCanvas();break;case"flip-horizontally":s.flipCanvasHorizontally();break;case"flip-vertically":s.flipCanvasVertically();break;case"adjustments":s.toggleFooter("adjustments");break;case"effects":s.toggleFooter("effects")}}).on("mouseleave","div",function(t){$(this).removeClass("clicked")}),this.$headerActions=this.$header.find(".actions").on("click",".do-save",function(t){t.preventDefault(),t.stopPropagation(),s.hide(!0)}).on("click",".do-cancel",function(t){t.preventDefault(),t.stopPropagation(),s.hide()}),this.$footer=this.$modal.find("footer"),this.$footer.on("click",".reset",function(t){var e=$(this).prev('input[type="range"]'),a=e.data("default");e.val(a).trigger("change")}),this.$footerInputs=this.$footer.find('input[type="range"]').on("change input",function(t){var e=$(this),a=e.next(".reset");e.val()==e.data("default")?a.addClass("disabled"):a.removeClass("disabled"),s.adjustCanvas(s.footerValues())}),this.$canvasWrapper.touch({useMouse:app.touch.useMouse,useTouch:app.touch.useTouch,trackDocument:!0,trackDocumentNormalize:!0,dragThreshold:0,dragDelay:0,tapAndHoldDelay:300,preventDefault:{drag:!0}}).on("dragStart tapAndHold",function(t,e){var a="scrollY"in window?window.scrollY:window.pageYOffset,i=$(document.elementFromPoint(e.x,e.y-a)).data("control");s.$crop.addClass("active"),i&&(this._control="cropControl_"+i,this._x=e.x,this._y=e.y)}).on("dragEnd",function(t,e){"_control"in this&&(delete this._x,delete this._y,delete this._control,s.$crop.removeClass("active"))}).on("drag",function(t,e){if("_control"in this){var a=e.x-this._x,i=e.y-this._y;s[this._control](a,i,e.ex,e.ey),s.redrawCrop(),this._x=e.x,this._y=e.y}}))},resetCrop:function(){this.crop.topLeft.x=.2*this.image.width,this.crop.topLeft.y=.2*this.image.height,this.crop.bottomRight.x=.8*this.image.width,this.crop.bottomRight.y=.8*this.image.height,this.crop.width()<this.settings.minWidth&&(x=Math.ceil((this.settings.minWidth-this.crop.width())/2),this.crop.topLeft.x=Math.max(0,this.crop.topLeft.x-x),this.crop.bottomRight.x=Math.min(this.image.width,this.crop.bottomRight.x+x)),this.crop.height()<this.settings.minHeight&&(x=Math.ceil((this.settings.minHeight-this.crop.height())/2),this.crop.topLeft.y=Math.max(0,this.crop.topLeft.y-x),this.crop.bottomRight.y=Math.min(this.image.height,this.crop.bottomRight.y+x))},cycleCropMode:function(){"off"==this.crop.mode?this.setCropMode("free"):"free"==this.crop.mode?this.setCropMode("fixed"):this.setCropMode("off")},refreshCropMode:function(){null===this.crop.mode&&(this.crop.mode="free"),this.setCropMode(this.crop.mode,!0)},setCropMode:function(t,e){var a,i,s,o;if(this.settings.forceCropMode){if(!e)return;t=this.settings.forceCropMode}switch(this.crop.mode=t,this.crop.mode){case"free":a="crop-fixed",i="Fixed Crop",this.$crop.show(),this.$cropMask.show(),this.resetCrop();break;case"fixed":if(a="crop-off",i="No Cropping",this.$crop.show(),this.$cropMask.show(),e&&this.resetCrop(),(s=Math.floor(this.crop.bottomRight.x-this.crop.topLeft.x))==(o=Math.floor(this.crop.bottomRight.y-this.crop.topLeft.y)))return;o<s?(this.crop.topLeft.x=this.crop.topLeft.x+(s-o)/2,this.crop.bottomRight.x=this.crop.topLeft.x+o):(this.crop.topLeft.y=this.crop.topLeft.y+(o-s)/2,this.crop.bottomRight.y=this.crop.topLeft.y+s);break;case"off":a="crop-free",i="Crop",this.$crop.hide(),this.$cropMask.hide(),this.crop.topLeft.x=0,this.crop.topLeft.y=0,this.crop.bottomRight.x=this.image.width,this.crop.bottomRight.y=this.image.height}this.redrawCrop(),this.updateMenuItem("crop",a,i)},snapCrop:function(t,e,a,i,s,o){var n,r,l,c;n=(l={topLeft:{x:this.crop.topLeft.x,y:this.crop.topLeft.y},bottomRight:{x:this.crop.bottomRight.x,y:this.crop.bottomRight.y}}).bottomRight.x-l.topLeft.x,r=l.bottomRight.y-l.topLeft.y,Math.floor(t)<=0?(a&&(l.topLeft.x=0),s&&(c=n)>l.topLeft.x&&(l.bottomRight.x=c)):Math.ceil(t)>=this.canvasWrapper.width&&(a&&(c=this.image.width-n)<l.bottomRight.x&&(l.topLeft.x=c),s&&(l.bottomRight.x=this.image.width)),Math.floor(e)<=0?(i&&(l.topLeft.y=0),o&&(c=r)>l.topLeft.y&&(l.bottomRight.y=c)):Math.ceil(e)>=this.canvasWrapper.height&&(i&&(c=this.image.height-r)<l.bottomRight.y&&(l.topLeft.y=c),o&&(l.bottomRight.y=this.image.height)),n=l.bottomRight.x-l.topLeft.x,r=l.bottomRight.y-l.topLeft.y,n<this.settings.minWidth||r<this.settings.minHeight||"fixed"==this.crop.mode&&n!=r||(this.crop.topLeft.x=l.topLeft.x,this.crop.topLeft.y=l.topLeft.y,this.crop.bottomRight.x=l.bottomRight.x,this.crop.bottomRight.y=l.bottomRight.y)},moveCrop:function(t,e,a,i){(this.crop.topLeft.x+t<0||this.crop.bottomRight.x+t>this.image.width)&&(t=0),(this.crop.topLeft.y+e<0||this.crop.bottomRight.y+e>this.image.height)&&(e=0),this.crop.topLeft.x+=t,this.crop.topLeft.y+=e,this.crop.bottomRight.x+=t,this.crop.bottomRight.y+=e},resizeCrop:function(t,e,a,i){var s=this.crop.bottomRight.x-this.crop.topLeft.x,o=this.crop.bottomRight.y-this.crop.topLeft.y;if(0<t&&s-t<this.settings.minWidth&&(t=0),a<0&&s+a<this.settings.minWidth&&(a=0),0<e&&o-e<this.settings.minHeight&&(e=0),i<0&&o+i<this.settings.minHeight&&(i=0),"fixed"==this.crop.mode){if(t<0&&this.crop.topLeft.x+t<0)return;if(0<a&&this.crop.bottomRight.x+a>this.image.width)return;if(e<0&&this.crop.topLeft.y+e<0)return;if(0<i&&this.crop.bottomRight.y+i>this.image.height)return}this.crop.topLeft.x+=t,this.crop.topLeft.y+=e,this.crop.bottomRight.x+=a,this.crop.bottomRight.y+=i,this.crop.topLeft.x=Math.max(this.crop.topLeft.x,0),this.crop.topLeft.y=Math.max(this.crop.topLeft.y,0),this.crop.bottomRight.x=Math.min(this.crop.bottomRight.x,this.image.width),this.crop.bottomRight.y=Math.min(this.crop.bottomRight.y,this.image.height)},redrawCrop:function(){var t,e,a,i,s;e=this.canvasWrapper.zoom*this.crop.topLeft.x,a=this.canvasWrapper.zoom*this.crop.topLeft.y,i=this.canvasWrapper.zoom*(this.crop.bottomRight.x-this.crop.topLeft.x),s=this.canvasWrapper.zoom*(this.crop.bottomRight.y-this.crop.topLeft.y),(t=this.crop.maskCanvas.getContext("2d")).globalCompositeOperation="source-over",this.crop.maskCanvas.width=Math.ceil(this.canvasWrapper.width),this.crop.maskCanvas.height=Math.ceil(this.canvasWrapper.height),t.clearRect(0,0,this.crop.maskCanvas.width,this.crop.maskCanvas.height),t.fillStyle="rgba(0,0,0,0.5)",t.fillRect(0,0,this.crop.maskCanvas.width,this.crop.maskCanvas.height),t.globalCompositeOperation="destination-out",t.fillStyle="#fff",t.fillRect(e,a,i,s),this.$crop.css("left",e).css("top",a).width(i).height(s)},attach:function(t){this.instance=t,this.image=t.image,this.settings=t.settings,this.crop.topLeft=t.image.crop.topLeft,this.crop.bottomRight=t.image.crop.bottomRight,this.$canvas=$(t.image.canvas).addClass("image").prependTo(this.$canvasWrapper),this.image.adjustments={},this.updateOriginal()},detach:function(){this.clearOriginal(),this.$canvas.removeClass("image").detach(),this.crop.topLeft=null,this.crop.bottomRight=null,this.instance=null,this.image=null,this.settings=null},show:function(t){var e=this;this.attach(t),this.resetFooter(),this.refreshCropMode(),this.settings.forceCropMode?this.disableMenuItem("crop"):this.enableMenuItem("crop"),this.settings.circle?this.$modal.addClass("circle"):this.$modal.removeClass("circle"),"filter"in CanvasRenderingContext2D.prototype&&"safari"!=browser.name&&"edge"!=browser.name&&"ie"!=browser.name||(this.disableMenuItem("adjustments"),this.disableMenuItem("effects")),this.rescale(),this.$modal.addClass("visible"),window.setTimeout(function(){e.$modal.focus()},250)},hide:function(t){t&&this.instance.sync(),this.detach(),this.$modal.removeClass("visible");var e=$("#ui");0<e.length&&e.focus()},isVisible:function(){return!!this.$modal.hasClass("visible")},updateOriginal:function(){var t;t=this.image.canvas.getContext("2d"),this.image.original=t.getImageData(0,0,this.image.width,this.image.height)},restoreOriginal:function(){var t;this.image.original&&((t=this.image.canvas.getContext("2d")).filter="none",t.putImageData(this.image.original,0,0))},clearOriginal:function(){this.image.original=null},applyAdjustments:function(){var t,e,a=[];context=this.image.canvas.getContext("2d"),t="blur"in this.image.adjustments?(e=Math.max(0,Math.min(100,this.image.adjustments.blur)),a.push("blur("+e/100*100+"px)"),2*e):0,"sepia"in this.image.adjustments&&a.push("sepia("+Math.max(0,Math.min(100,this.image.adjustments.sepia))+"%)"),"grayscale"in this.image.adjustments&&a.push("grayscale("+Math.max(0,Math.min(100,this.image.adjustments.grayscale))+"%)"),"invert"in this.image.adjustments&&a.push("invert("+Math.max(0,Math.min(100,this.image.adjustments.invert))+"%)"),"hue"in this.image.adjustments&&a.push("hue-rotate("+Math.max(0,Math.min(360,this.image.adjustments.hue))+"deg)"),"saturation"in this.image.adjustments&&a.push("saturate("+Math.max(0,Math.min(200,this.image.adjustments.saturation))+"%)"),"brightness"in this.image.adjustments&&a.push("brightness("+Math.max(0,Math.min(200,this.image.adjustments.brightness))+"%)"),"contrast"in this.image.adjustments&&a.push("contrast("+Math.max(0,Math.min(200,this.image.adjustments.contrast))+"%)"),context.filter=0<a.length?a.join(" "):"none",context.drawImage(this.image.canvas,-1*t,-1*t,this.image.width+2*t,this.image.height+2*t)},adjustCanvas:function(t){this.image.adjustments=t||{},this.restoreOriginal(),this.applyAdjustments()},flipCanvasHorizontally:function(){var t,e,a,i;this.restoreOriginal(),a=this.image.canvas.getContext("2d"),e=(t=document.createElement("canvas")).getContext("2d"),t.width=this.image.width,t.height=this.image.height,e.drawImage(this.image.canvas,0,0),a.save(),a.clearRect(0,0,this.image.width,this.image.height),a.translate(this.image.width,0),a.scale(-1,1),a.drawImage(t,0,0),a.restore(),delete t,i={topLeft:{x:this.crop.topLeft.x,y:this.crop.topLeft.y},bottomRight:{x:this.crop.bottomRight.x,y:this.crop.bottomRight.y}},this.crop.topLeft.x=this.image.width-i.bottomRight.x,this.crop.bottomRight.x=this.image.width-i.topLeft.x,this.updateOriginal(),this.applyAdjustments(),this.redrawCrop()},flipCanvasVertically:function(){var t,e,a,i;this.restoreOriginal(),a=this.image.canvas.getContext("2d"),e=(t=document.createElement("canvas")).getContext("2d"),t.width=this.image.width,t.height=this.image.height,e.drawImage(this.image.canvas,0,0),a.save(),a.clearRect(0,0,this.image.width,this.image.height),a.translate(0,this.image.height),a.scale(1,-1),a.drawImage(t,0,0),a.restore(),delete t,i={topLeft:{x:this.crop.topLeft.x,y:this.crop.topLeft.y},bottomRight:{x:this.crop.bottomRight.x,y:this.crop.bottomRight.y}},this.crop.topLeft.y=this.image.height-i.bottomRight.y,this.crop.bottomRight.y=this.image.height-i.topLeft.y,this.updateOriginal(),this.applyAdjustments(),this.redrawCrop()},rotateCanvas:function(){var t,e,a,i,s,o,n,r,l=Math.PI/180*90;this.restoreOriginal(),i=this.image.canvas.width/2,s=this.image.canvas.height/2,o=this.image.width,n=this.image.height,t=this.image.canvas.getContext("2d"),a=(e=document.createElement("canvas")).getContext("2d"),e.width=o,e.height=n,a.putImageData(t.getImageData(0,0,o,n),0,0),r=this.image.canvas.width,this.image.canvas.width=this.image.canvas.height,this.image.canvas.height=r,r=this.image.width,this.image.width=this.image.height,this.image.height=r,t.save(),t.translate(s,i),t.rotate(l),t.drawImage(e,o/-2,n/-2,o,n),t.restore(),r={topLeft:{x:this.crop.topLeft.x,y:this.crop.topLeft.y},bottomRight:{x:this.crop.bottomRight.x,y:this.crop.bottomRight.y}},this.crop.topLeft.x=this.image.width-r.bottomRight.y,this.crop.topLeft.y=r.topLeft.x,this.crop.bottomRight.x=this.image.width-r.topLeft.y,this.crop.bottomRight.y=r.bottomRight.x,delete e,this.updateOriginal(),this.applyAdjustments(),this.rescale()},rescale:function(){var t=this.$window.width(),e=this.$window.height(),a=this.$wrapper.width(),i=e-this.$header.outerHeight()-this.$footer.outerHeight(),s=padHeight=Math.max(60,t/1440*75);t<480?s=padHeight=40:t<736&&(s=padHeight=60),this.canvasWrapper.width=a-s,this.canvasWrapper.height=i-padHeight,this.image.width<this.canvasWrapper.width&&this.image.height<this.canvasWrapper.height?(this.canvasWrapper.zoom=1,this.canvasWrapper.width=this.image.width,this.canvasWrapper.height=this.image.height):(this.canvasWrapper.zoom=Math.min(this.canvasWrapper.height/this.image.height,this.canvasWrapper.width/this.image.width),this.canvasWrapper.width=this.canvasWrapper.zoom*this.image.width,this.canvasWrapper.height=this.canvasWrapper.zoom*this.image.height),this.$canvasWrapper.width(this.canvasWrapper.width).height(this.canvasWrapper.height),this.$canvas.width(this.canvasWrapper.zoom*this.image.width).height(this.canvasWrapper.zoom*this.image.height),this.redrawCrop()},cropControl_move:function(t,e,a,i){this.moveCrop(t/this.canvasWrapper.zoom,e/this.canvasWrapper.zoom,a,i),this.snapCrop(a,i,!0,!0,!0,!0)},cropControl_topLeft:function(t,e,a,i){"fixed"==this.crop.mode&&(Math.abs(t)>Math.abs(e)?e=t:t=e),this.resizeCrop(t/this.canvasWrapper.zoom,e/this.canvasWrapper.zoom,0,0),this.snapCrop(a,i,!0,!0,!1,!1)},cropControl_topRight:function(t,e,a,i){"fixed"==this.crop.mode&&(Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e),this.resizeCrop(0,e/this.canvasWrapper.zoom,t/this.canvasWrapper.zoom,0),this.snapCrop(a,i,!1,!0,!0,!1)},cropControl_bottomRight:function(t,e,a,i){"fixed"==this.crop.mode&&(Math.abs(t)>Math.abs(e)?e=t:t=e),this.resizeCrop(0,0,t/this.canvasWrapper.zoom,e/this.canvasWrapper.zoom),this.snapCrop(a,i,!1,!1,!0,!0)},cropControl_bottomLeft:function(t,e,a,i){"fixed"==this.crop.mode&&(Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e),this.resizeCrop(t/this.canvasWrapper.zoom,0,0,e/this.canvasWrapper.zoom),this.snapCrop(a,i,!0,!1,!1,!0)},cropControl_top:function(t,e,a,i){"fixed"==this.crop.mode?Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e:t=0,this.resizeCrop(-.5*t/this.canvasWrapper.zoom,e/this.canvasWrapper.zoom,.5*t/this.canvasWrapper.zoom,0),this.snapCrop(a,i,!1,!0,!1,!1)},cropControl_right:function(t,e,a,i){"fixed"==this.crop.mode?Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e:e=0,this.resizeCrop(0,.5*e/this.canvasWrapper.zoom,t/this.canvasWrapper.zoom,-.5*e/this.canvasWrapper.zoom),this.snapCrop(a,i,!1,!1,!0,!1)},cropControl_bottom:function(t,e,a,i){"fixed"==this.crop.mode?Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e:t=0,this.resizeCrop(.5*t/this.canvasWrapper.zoom,0,-.5*t/this.canvasWrapper.zoom,e/this.canvasWrapper.zoom),this.snapCrop(a,i,!1,!1,!1,!0)},cropControl_left:function(t,e,a,i){"fixed"==this.crop.mode?Math.abs(t)>Math.abs(e)?e=-1*t:t=-1*e:e=0,this.resizeCrop(t/this.canvasWrapper.zoom,-.5*e/this.canvasWrapper.zoom,0,.5*e/this.canvasWrapper.zoom),this.snapCrop(a,i,!0,!1,!1,!1)},headerMenuItems:{},footerSections:{},updateMenuItem:function(t,e,a){var i;(i=this.getMenuItem(t)).$icon.attr("xlink:href","#icon-"+e),i.$item.attr("data-tooltip",a)},getMenuItem:function(t){return t in this.headerMenuItems||($item=this.$headerMenu.find('[data-name="'+t+'"]'),$icon=$item.find("use"),this.headerMenuItems[t]={$item:$item,$icon:$icon}),this.headerMenuItems[t]},enableMenuItem:function(t){this.getMenuItem(t).$item.removeClass("disabled")},disableMenuItem:function(t){this.getMenuItem(t).$item.addClass("disabled")},toggleFooter:function(t){var e,a,i;t in this.footerSections||(this.footerSections[t]=this.$footer.find('[data-name="'+t+'"]')),e=this.footerSections[t],a=this.getMenuItem(t),i=e.hasClass("active"),this.$footer.children().removeClass("active"),this.$headerMenu.children().removeClass("active"),i||(e.addClass("active"),a.$item.addClass("active")),this.rescale()},resetFooter:function(){this.$headerMenu.children().removeClass("active"),this.$footer.children().removeClass("active"),this.$footerInputs.each(function(){var t=$(this),e=t.next(".reset");t.val(t.data("default")),e.addClass("disabled")})},footerValues:function(){var a={};return this.$footerInputs.each(function(){var t=$(this),e=t.val();e!=t.data("default")&&(a[t.attr("name")]=e)}),a}};$.fn.formImageUploader=function(){var t=$(this);if(0==this.length)return t;if(1<this.length){for(var e=0;e<this.length;e++)$(this[e]).formImageUploader();return t}return"_formImageUploader"in this[0]?this[0]._formImageUploader.$idInput.triggerHandler("--refresh-image"):this[0]._formImageUploader=new i(t),t},void 0!==e&&(e.exports=i)},{}],formVideoUploader:[function(t,e,a){function i(t){var e,s=this;this.inputPrefix="",this.video={width:0,height:0,type:null,size:0},this.settings={mode:"data",maxSize:2048,inArray:!1},this.$window=$(window),this.$obj=t.addClass("form-video-uploader"),void 0!==(e=this.$obj.attr("data-mode"))&&(this.settings.mode=e),void 0!==(e=this.$obj.attr("data-maxSize"))&&(this.settings.maxSize=parseInt(e)),void 0!==(e=this.$obj.attr("data-inArray"))&&(this.settings.inArray="1"==e),this.$idInput=this.$obj.find(".id").css("position","absolute").css("width","0px").css("height","0px").css("visibility","hidden").css("z-index","-1").css("overflow","hidden").css("-moz-pointer-events","none").css("-webkit-pointer-events","none").css("-ms-pointer-events","none").css("pointer-events","none").on("--refresh-video",function(){var t,e;t=s.$dataInput.val(),e=s.$idInput.val(),t&&e?(s.$thumbnail_video.attr("src",t),s.$obj.removeClass("new")):(s.$thumbnail_video.attr("src",""),s.$obj.addClass("new"))}),this.$dataInput=this.$obj.find(".data").css("display","none"),this.$thumbnail=$('<div class="thumbnail"></div>').appendTo(this.$obj).css("background-size","cover").css("background-position","center").on("click",function(t){t.preventDefault(),t.stopPropagation(),s.$idInput.prop("disabled")||s.$fileInput.trigger("click")}),this.$thumbnail_img=$("<img />").appendTo(this.$thumbnail),this.$thumbnail_canvas=document.createElement("canvas"),this.$thumbnail_context=this.$thumbnail_canvas.getContext("2d"),this.$thumbnail_video=$('<video src="" autoplay muted playsinline />').on("loadeddata",function(){var t,e,a,i;t=s.$thumbnail_canvas,e=s.$thumbnail_context,a=s.$thumbnail_video[0],t.width=a.videoWidth,t.height=a.videoHeight,setTimeout(function(){e.drawImage(a,0,0),i=t.toDataURL("image/jpeg",1),s.$thumbnail_img.attr("src",i),e.clearRect(0,0,t.width,t.height)},"ie"==browser.name||"edge"==browser.name?100:0)}),this.$obj.on("click",".do-upload",function(t){t.preventDefault(),t.stopPropagation(),s.$idInput.prop("disabled")||s.$fileInput.trigger("click")}).on("keydown",".do-upload",app.keyHandler).on("dragover",function(t){return s.$obj.addClass("is-dragOver"),!1}).on("drop dragleave",function(t){return s.$obj.removeClass("is-dragOver"),!1}).on("drop",function(t){var e=t.originalEvent.dataTransfer.files;e.length;return s.load(e[0]),s.$fileInput.val(""),!1}),this.$obj.on("click",".do-clear",function(t){t.preventDefault(),t.stopPropagation(),s.$idInput.prop("disabled")||(s.$video.attr("src",""),s.$thumbnail_video.attr("src",""),currentUrl=s.$dataInput.val(),"object"==s.settings.mode&&currentUrl&&app.objectUrl.is(currentUrl)&&app.objectUrl.revoke(currentUrl),s.$dataInput.val("").trigger(s.settings.inArray?"change-in-array":"change"),s.$idInput.val("").trigger("change",["formVideoUploader.clear"]),s.$obj.addClass("new"))}).on("keydown",".do-clear",app.keyHandler),this.$video=$("<video />").on("loadeddata",function(){s.completeLoad()}),this.$fileInput=$('<input type="file" name="video" autocomplete="off" accept="video/mp4" />').on("change",function(){s.load(s.$fileInput.prop("files")[0]),s.$fileInput.val("")}),this.$idInput.triggerHandler("--refresh-video")}i.prototype.sync=function(t){var e;this.$thumbnail_video.attr("src",t),e=this.$dataInput.val(),"object"==this.settings.mode&&e&&app.objectUrl.is(e)&&app.objectUrl.revoke(e),this.$dataInput.val(t).trigger(this.settings.inArray?"change-in-array":"change"),this.$idInput.val(md5(String(Date.now())+t)).trigger("change",["formVideoUploader.sync"]),this.$obj.removeClass("new")},i.prototype.load=function(a){var i=this;a&&this.getVideoProperties(a,function(t){var e;switch(i.video.type=t.type,i.video.size=t.size,i.video.width=0,i.video.height=0,i.video.type){case"video/mp4":case"video/x-m4v":if(Math.floor(i.video.size/1024)>i.settings.maxSize)return void app.dialog.show({title:"Video too large",message:"Sorry, videos cannot exceed "+i.settings.maxSize/1024+"MB in file size."});break;default:return void app.dialog.show({title:"Invalid video type",message:"Sorry, videos must be in MP4 format."})}e=app.objectUrl.create(a),i.$video.attr("src","").attr("src",e)})},i.prototype.completeLoad=function(){var t,e=this;switch(t=this.$video.attr("src"),this.video.width=this.$video[0].videoWidth,this.video.height=this.$video[0].videoHeight,this.settings.mode){case"object":case"object-manual":t&&app.objectUrl.is(t)?this.sync(t):app.objectUrl.createFromUrl(t,function(t){e.sync(t)});break;default:case"data":t&&app.dataUrl.is(t)?this.sync(t):app.dataUrl.createFromUrl(t,function(t){e.sync(t)})}},i.prototype.getVideoProperties=function(a,i){var t=new FileReader;t.onload=function(t){var e={};e.type=a.type,e.size=a.size,i(e)},t.readAsArrayBuffer(a)},$.fn.formVideoUploader=function(){var t=$(this);if(0==this.length)return t;if(1<this.length){for(var e=0;e<this.length;e++)$(this[e]).formVideoUploader();return t}return"_formVideoUploader"in this[0]||(this[0]._formVideoUploader=new i(t)),t},void 0!==e&&(e.exports=i)},{}],form:[function(t,e,a){$.valHandlers=[];t("./formColorPicker.js"),t("./formArray.js"),t("./formImageUploader.js"),t("./formVideoUploader.js");function i(t,e){var a=this;this.$obj=t,this.options=$.extend({fields:{},types:{},verify:{},alertHandler:null,preSubmitHandler:null,conditionsHandler:null,submitHandler:function(t){a.submitHandler(t)},validation:!!t.is("[data-validation]"),explicitSubmit:!!t.is("[data-explicit-submit]")},e),this.$alert=$('<div class="alert">what what</div>').prependTo(this.$obj).hide(),this.alertTimers=[],this.initTypes(),this.initRequires(),this.initConditions(),this.initFields(),this.init()}i.prototype.statusTables={"font-weight":{100:"Thin",200:"Extra Light",300:"Light",400:"Regular",500:"Medium",600:"Semi Bold",700:"Bold",800:"Extra Bold",900:"Heavy"}},i.prototype.option=function(t,e){return t in this.options?(void 0!==e&&(this.options[t]=e),this.options[t]):null},i.prototype.value=function(t,e){var a=this.$obj.find("#"==t.charAt(0)?'input[id="'+t.substr(1)+'"],select[id="'+t.substr(1)+'"]':'input[name="'+t+'"],select[name="'+t+'"]');return 0==a.length||!0===a.prop("disabled")?null:(void 0!==e&&a.val(e),a.val())},i.prototype.showAlert=function(t,e){var a=this,i=25*e.length;a.options.alertHandler&&a.options.alertHandler.apply(a),this.clearAlert(),a.$alert.addClass(t).text(e),a.alertTimers.push(window.setTimeout(function(){a.$alert.show(),a.$obj.hasClass("minimal")||app.scrollTo({$target:a.$alert,center:!0}),a.alertTimers.push(window.setTimeout(function(){a.$alert.addClass("visible")},100)),a.alertTimers.push(window.setTimeout(function(){a.$alert.removeClass("visible")},2e3+i)),a.alertTimers.push(window.setTimeout(function(){a.clearAlert()},2250+i))},0))},i.prototype.clearAlert=function(){for(var t in this.alertTimers)window.clearTimeout(this.alertTimers[t]);this.alertTimers=[],this.$alert.hide().text("").removeClass("visible").removeClass("error").removeClass("success")},i.prototype.flag=function(t,e,a){$parent=t.parent(),a?(t.attr("data-"+e,"1").data(e,"1"),$parent.hasClass("input-wrapper")&&$parent.attr("data-"+e,"1").data(e,"1")):(t.removeAttr("data-"+e).removeData(e),$parent.hasClass("input-wrapper")&&$parent.removeAttr("data-"+e).removeData(e))},i.prototype.is=function(t,e){return t in this.options.types?this.options.types[t](e):web.is(t,e)},i.prototype.isValid=function(){return 0===this.$obj.find("[data-invalid]:enabled,[data-missing]:enabled,[data-unverified]:enabled").length},i.prototype.submitHandler=function(e){var t,a=this,i=this.$obj.data("action");i&&"#"!=i&&(t=function(){$.ajax({type:"POST",url:i+(-1==i.indexOf("?")?"?":"&")+"ajax=1",data:a.$obj.serialize(),dataType:"json",error:function(t,e,a){window.location.reload()},success:function(t){switch(t.action){case"alert":a.showAlert(t.type,t.message);break;case"reload":return void window.location.replace(window.location.href);case"redirect":return"dashboardAlert"in t&&"dashboard"in app&&app.dashboard.setAlert(t.dashboardAlert),void("delay"in t?(app.dialog.preshow(),setTimeout(function(){window.location.replace(t.url)},t.delay)):window.location.replace(t.url));default:a.showAlert("success","Ok.")}if(a.$obj.find('input[name="'+t._key+'"]').val(t[t._key]),e(),t.reset){if(!0===t.reset)a.$obj.get(0).reset();else if($.isArray(t.reset))for(k in t.reset)a.$obj.find('input[name="'+t.reset[k]+'"],select[name="'+t.reset[k]+'"]').val("").removeProp("checked");else a.$obj.find('input[name="'+t.reset+'"],select[name="'+t.reset+'"]').val("").removeProp("checked");a.$obj.find("input, select, textarea").trigger("change",["form.submitHandler.reset"])}t.focus&&a.$obj.find('input[name="'+t.focus+'"]').focus(),t.callback&&window[t.callback]()}})},window.setTimeout(function(){a.options.preSubmitHandler?a.options.preSubmitHandler.apply(a,[t]):t()},250))},i.prototype.validate=function(t){var e=t.data("type"),a=1==t.data("optional")||!0===t.prop("disabled"),i=t.val();"checkbox"==t.attr("type")&&(i=t.prop("checked")?"on":""),e=e||"any",""==i?(this.flag(t,"invalid",!1),this.flag(t,"missing",!a)):(this.flag(t,"missing",!1),this.flag(t,"invalid",!this.is(e,i))),this.isValid()?this.enableSubmits():this.disableSubmits()},i.prototype.$submits=function(){return $('input[form="'+this.$obj.attr("id")+'"]').add(this.$obj.find('input[type="submit"]'))},i.prototype.enableSubmits=function(){var t=this.$submits();t.prop("disabled",!1),t.removeClass("is-submitting")},i.prototype.disableSubmits=function(t){var e=this.$submits();e.prop("disabled",!0),t&&e.addClass("is-submitting")},i.prototype.initFields=function(){var t,e,a,i;for(t in this.options.fields)if(e=this.options.fields[t],i=(a=this.$obj.find('[name="'+t+'"]')).attr("type"),"value"in e)switch(i){case"radio":a.filter('[value="'+e.value+'"]').prop("checked",!0);break;case"checkbox":a.prop("checked",e.value);break;default:a.val(e.value)}},i.prototype.initRequires=function(t,e){var a=t||this.$obj,g=e||this.$obj,f=this;a.data("form-init-requires")||(a.data("form-init-requires",!0),a.find("[data-requires]").each(function(){var t,e,a,i,s,o,n,r,l,c,h=$(this),p=h.data("requires").split("&"),d=h.find("input,select,textarea").not("[data-requires-ignore]"),u=[];for(c in t=function(){var t,e,a=h.find("input,select,textarea,a,.button,.form-array,.form-array .item");if(u[0].or)for(e in t=!1,u)t=u[e].fTest()||t;else for(e in t=!0,u)t=u[e].fTest()&&t;if(t){if(!h.hasClass("inactive"))return;d.not("[data-requires-ignore]").prop("disabled",!1),f.options.explicitSubmit||d.not("[data-requires-ignore]").trigger("change",["form.initRequires.positive"]),h.removeClass("inactive"),a.each(function(){var t=$(this);t.data("tabindex")?(t.attr("tabindex",t.data("tabindex")),t.removeData("tabindex")):t.removeAttr("tabindex")}),d.filter("textarea[data-autosize]").triggerHandler("--refresh-input"),h.hasClass("half")&&(h.hasClass("first")?h.next().removeClass("after-inactive"):h.prev().removeClass("before-inactive"))}else{if(h.hasClass("inactive"))return;d.not("[data-requires-ignore]").prop("disabled",!0),h.addClass("inactive"),a.each(function(){var t=$(this);t.attr("tabindex")&&t.data("tabindex",t.attr("tabindex")),t.attr("tabindex","-1")}),h.hasClass("half")&&(h.hasClass("first")?h.next().addClass("after-inactive"):h.prev().addClass("before-inactive"))}},p){switch(r=n=!1,"!"==(e=(l=p[c].split("="))[0]).substr(-1)&&(e=e.substr(0,e.length-1),n=!0),"?"==e.substr(-1)&&(e=e.substr(0,e.length-1),r=!0),1==(a=l[1].split(",")).length&&(a=[a]),(i=g.find('[name="'+e+'"]').on("change",t)).attr("type")){case"radio":s=function(){return this.$input.filter(":checked").val()};break;case"checkbox":s=function(){return this.$input.prop("checked")?"on":"off"};break;default:s=function(){return this.$input.val()}}o=function(){var t,e=this.fValue();if(this.invert){for(t in this.value)if(e==this.value[t])return!1;return!0}for(t in this.value)if(e==this.value[t])return!0;return!1},u.push({key:e,value:a,$input:i,fValue:s,fTest:o,invert:n,or:r})}t()}))},i.prototype.initConditions=function(t,e){var a=t||this.$obj,i=e||this.$obj,r=this;if(!a.data("form-init-conditions")){a.data("form-init-conditions",!0);function s(t){i.find("[data-conditions]").each(function(){var t,e,a=$(this),i=a.data("conditions").split(","),s=a.find("input,select,textarea").not("[data-conditions-ignore]"),o=a.find("input,select,textarea,a,.button,.form-array,.form-array .item"),n=!0;for(t=0;t<i.length;t++)n="!"==(e=i[t]).charAt(0)?(e=e.substr(1),n&&!r.options.conditionsHandler(e)):n&&r.options.conditionsHandler(e);if(n){if(!a.hasClass("inactive"))return;s.not("[data-conditions-ignore]").prop("disabled",!1),r.options.explicitSubmit||s.not("[data-conditions-ignore]").trigger("change",["form.initConditions.positive"]),a.removeClass("inactive"),o.each(function(){var t=$(this);t.data("tabindex")?(t.attr("tabindex",t.data("tabindex")),t.removeData("tabindex")):t.removeAttr("tabindex")}),s.filter("textarea[data-autosize]").triggerHandler("--refresh-input"),a.hasClass("half")&&(a.hasClass("first")?a.next().removeClass("after-inactive"):a.prev().removeClass("before-inactive"))}else{if(a.hasClass("inactive"))return;s.not("[data-conditions-ignore]").prop("disabled",!0),a.addClass("inactive"),o.each(function(){var t=$(this);t.attr("tabindex")&&t.data("tabindex",t.attr("tabindex")),t.attr("tabindex","-1")}),a.hasClass("half")&&(a.hasClass("first")?a.next().addClass("after-inactive"):a.prev().addClass("before-inactive"))}})}a.on("change","input, select, textarea",s),s()}},i.prototype.initTypes=function(t){var e=t||this.$obj;e.data("form-init-types")||(e.data("form-init-types",!0),t||this.initType_Array(this.$obj),this.initType_ImageUploader(e),this.initType_VideoUploader(e),this.initType_ColorPicker(e),this.initType_Toggle(e),this.initType_Range(e),this.initType_Textarea(e),this.initType_Text(e))},i.prototype.initType_Array=function(t){t.find(".form-array").formArray(this)},i.prototype.initType_ImageUploader=function(t){t.find(".form-image-uploader").formImageUploader()},i.prototype.initType_VideoUploader=function(t){t.find(".form-video-uploader").formVideoUploader()},i.prototype.initType_ColorPicker=function(t){t.find('input[type="hexcolor"]').formColorPicker()},i.prototype.initType_Text=function(t){t.on("focus",".input-wrapper input",function(t){$(this).parent().addClass("focus")}).on("blur",".input-wrapper input",function(t){$(this).parent().removeClass("focus")}).on("mousedown",".input-wrapper .prefix",function(t){t.preventDefault(),t.stopPropagation(),$(this).next().focus()}).on("mousedown",".input-wrapper .suffix",function(t){t.preventDefault(),t.stopPropagation(),$(this).prev().focus()}),t.find('input[type="text"][data-prefix], input[type="text"][data-suffix]').each(function(){var t,e,a,i=$(this);a=i.data("suffix"),e=i.data("prefix"),t=$('<div class="input-wrapper" />').insertBefore(i),i.removeAttr("data-prefix").removeAttr("data-suffix").removeData("prefix").removeData("suffix").attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false").appendTo(t),e&&$('<div class="prefix">'+e+"</div>").prependTo(t),a&&$('<div class="suffix">'+a+"</div>").appendTo(t)}),t.find('input[type="text"][data-inline-suffix]').each(function(){var s,t,o,e,n=$(this);t=n.data("inline-suffix"),o=n.attr("maxlength"),e=n.attr("placeholder"),n.attr("type","hidden").removeAttr("placeholder").removeAttr("maxlength").removeAttr("data-inline-suffix").removeData("inline-suffix").on("change",function(t){var e=n.val();o<e&&(e=e.substr(0,o),n.val(e)),s.text(e)}),s=$('<div class="facade text"></div>').attr("contenteditable","true").attr("data-suffix",t).attr("data-placeholder",e).attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false").insertAfter(n).on("keydown",function(t){switch(t.keyCode){case 13:case 27:t.preventDefault(),t.stopPropagation(),s.blur();break;case 32:t.preventDefault(),t.stopPropagation()}}).on("change input",function(t){var e=s.text();if(""==e.trim())e="",s.text("");else if(e.length>o){var a=window.getSelection(),i=a.getRangeAt(0).endOffset-1;e=e.substr(0,o),s.text(e),a.collapse(s[0].firstChild,Math.min(o,1+i))}n.val(e)}).on("keyup",function(t){9==t.keyCode&&getSelection().selectAllChildren(s[0])}).on("blur",function(t){getSelection().removeAllRanges()}),n.triggerHandler("change")}),t.find('input[type="text"][data-suffixes]').each(function(){var a,s,o,t,e,n=$(this),r=n.next("select"),l=r.children("option");t=$('<div class="input-wrapper" />').insertBefore(n),n.attr("autocomplete","off").attr("autocorrect","off").attr("autocapitalize","off").attr("spellcheck","false").on("keydown blur mousedown",function(t){a.removeClass("active")}).appendTo(t),r.hide().appendTo(t).attr("data-optional","1").data("optional","1").on("change",function(t,e){var a=r.val(),i=l.filter('[value="'+a+'"]').text();t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),o.text(i),s.removeClass("selected"),s.filter('[data-value="'+a+'"]').addClass("selected"),n.trigger("change-suffixes",[a,i]),"form.initType_Text.suffixes.click"==e&&""!=$.fn.origVal.call(n)&&n.trigger("input").trigger("change")}),l=r.children(),a=$('<div class="suffixes"><div class="status"></div><div class="options">'+(e="",l.each(function(){var t=$(this);e+='<div class="option" data-value="'+t.attr("value")+'"><span>'+t.text()+"</span></div>"}),e)+"</div></div>").appendTo(t).on("mousedown",function(t){t.preventDefault(),t.stopPropagation()}).on("click",".option:not(.disabled)",function(t){var e=$(this).data("value");a.removeClass("active"),r.val()!=e&&r.val(e).triggerHandler("change",["form.initType_Text.suffixes.click"])}),o=a.children(".status").on("click",function(t){browser.mobile||n.focus(),a.toggleClass("active")}),s=a.children(".options").children(),r.triggerHandler("change",["form.initType_Text.suffixes.init"])})},i.prototype.initType_Toggle=function(t){t.find(".toggle-wrapper").attr("tabIndex","0"),t.on("blur",".toggle-wrapper",function(t){$(this).removeClass("is-clicked")}).on("mousedown",".toggle-wrapper",function(t){$(this).addClass("is-clicked")}).on("keydown",".toggle-wrapper",function(t){var e,a=$(this),i=a.find("input"),s=i.filter(":checked");switch(t.keyCode){case 39:case 32:case 13:t.preventDefault(),t.stopPropagation(),0==(e=s.next("label").next("input")).length&&(e=i.first()),e.trigger("click");break;case 37:t.preventDefault(),t.stopPropagation(),0==(e=s.prev("label").prev("input")).length&&(e=i.last()),e.trigger("click");break;case 27:t.preventDefault(),t.stopPropagation(),a.blur();break;default:return app.keyHandler.apply(this,[t])}})},i.prototype.initType_Range=function(t){var d=this;t.find('input[type="range"][data-status]').each(function(){var r,t,e,a,i,l=$(this),c=$('<div class="input-range-status" contenteditable />').insertBefore(l),h=l.data("status"),p=l.data("status-args");if(p){for(t=p.split("&"),a={},i=0;i<t.length;i++)a[(e=t[i].split("="))[0].toString()]=e[1];p=a}else p={};l.on("change.status",function(t){var e,a=l.val(),i=h.split(",");if("rename"==i[0]?a.toString()in p?a=p[a.toString()]:e=0<i.length?i[1]:null:e=i[0],e)switch(e){case"seconds":a=parseFloat(a)/1e3+"s";break;case"degrees":a+="&deg;";break;case"percentage":a+="%";break;case"points":a+="pt";break;case"font-weight":a in d.statusTables["font-weight"]&&(a=d.statusTables["font-weight"][a])}c.html(a)}).triggerHandler("change.status"),c.on("keydown",function(t){13!=t.keyCode&&27!=t.keyCode||(t.stopPropagation(),t.preventDefault(),c.blur())}).on("focus",function(t){var e;switch(r=c.text(),h){case"rename":e=r;break;case"seconds":null!==(e=parseFloat(r))&&!isNaN(e)||(e="");break;case"font-weight":e=r;break;default:null!==(e=parseFloat(r))&&!isNaN(e)||(e="")}c.text(e),setTimeout(function(){getSelection().selectAllChildren(c[0])},0)}).on("blur",function(t){var e,a,i,s=c.text(),o=parseFloat(l.attr("min")),n=parseFloat(l.attr("max"));switch(h){case"rename":for(e in a=web.friendlyfy(s.replace(/\s/g,"")),i=null,p)if(a==web.friendlyfy(p[e].replace(/\s/g,""))){i=e;break}null===(a=i)&&(a=null===(a=parseFloat(s))||isNaN(a)?null:Math.min(Math.max(a,o),n));break;case"seconds":a=null===(a=parseFloat(s))||isNaN(a)?null:(a=parseInt(1e3*a),Math.min(Math.max(a,o),n));break;case"font-weight":for(e in a=web.friendlyfy(s.replace(/\s/g,"")),i=null,d.statusTables["font-weight"])if(a==web.friendlyfy(d.statusTables["font-weight"][e].replace(/\s/g,""))||a==e){i=e;break}a=i;break;default:a=null===(a=parseFloat(s))||isNaN(a)?null:Math.min(Math.max(a,o),n)}null!==a?l.val(a).trigger("change",["form.initType_Range.rangeStatus"]):c.text(r),getSelection().removeAllRanges()})})},i.prototype.initType_Textarea=function(t){var e=this;t.find("textarea[data-autosize]").each(function(){var i=$(this),s=i.parent(),t=1==i.filter("[data-autosize-newline]").length;i.attr("rows","1").css("overflow","hidden").css("resize","none").on("keydown",t?function(t){13==t.keyCode&&(t.ctrlKey?(t.preventDefault(),i.blur(),e.$submits().prop("disabled")||0!=i.parents(".form-array").length||e.options.explicitSubmit||e.$obj.trigger("submit")):t.stopPropagation())}:function(t){13==t.keyCode&&(t.preventDefault(),i.blur(),e.$submits().prop("disabled")||0!=i.parents(".form-array").length||e.options.explicitSubmit||e.$obj.trigger("submit"))}).on("--refresh-input",function(t){function e(){var t,e;return t=i.prop("scrollHeight")-4,isNaN(e=parseInt(i.data("autosizeLimit")))||(e<t&&(a=!0),t=Math.min(e,t)),t+"px"}var a=!1;s.css("min-height",e()),i.css("height","auto").css("height",e()),a?i.css("overflow-y","scroll").attr("data-autosize-limited","1"):i.css("overflow-y","hidden").removeAttr("data-autosize-limited"),window.setTimeout(function(){i.css("height",e()),s.css("min-height",e())},100)}).on("input blur focus change",function(t){i.triggerHandler("--refresh-input"),e.$obj.triggerHandler("--refresh-autosize")}).on("keydown",function(t){9==t.keyCode&&i.select()}).triggerHandler("--refresh-input")})},i.prototype.init=function(){var r=this;if("ie"!=browser.name&&"edge"!=browser.name&&this.$obj.on("input",'input[type="range"]',function(){$(this).trigger("change",["form.rangeFix"])}),this.$obj.on("click","label",function(t){var e=$(this).prev().attr("type");"checkbox"!=e&&"radio"!=e&&t.preventDefault()}),("ie"==browser.name||"edge"==browser.name)&&this.$obj.attr("id")){r=this;$('input[form="'+this.$obj.attr("id")+'"]').on("click",function(t){t.preventDefault(),t.stopPropagation(),r.$obj.trigger("submit")})}if(this.$obj.on("keydown","input, textarea, select",function(t){27==t.keyCode&&$(this).blur()}),this.options.explicitSubmit?this.$obj.on("keydown","input,select,textarea",function(t){var e=$(this);13==t.keyCode&&(t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation(),e.blur())}):this.$obj.on("keydown","input,select,textarea",function(t){13==t.keyCode&&t.ctrlKey&&r.$obj.trigger("submit")}),this.options.validation&&this.$obj.on("change blur keyup","input,select,textarea",function(){r.validate($(this))}),!$.isEmptyObject(this.options.verify)){var t,e,a;for(t in this.$obj.on("--refresh-verify",function(t){r.$obj.find("input,select,textarea").each(function(){var t=$(this),e=t.attr("name"),a=t.val();e in r.options.verify&&!0!==t.prop("disabled")&&(""==a?r.flag(t,"unverified",!0):t.data("verify-originalValue",a))})}),this.$obj.on("keydown","input,select,textarea",function(t){var e=$(this),a=e.attr("name");13==t.keyCode&&a in r.options.verify&&!1===e.prop("disabled")&&(t.preventDefault(),t.stopPropagation(),e.blur())}).on("input","input,select,textarea",function(t){var i=$(this),e=i.parent(),s=e.hasClass("input-wrapper")?e.next(".message"):i.next(".message"),o=i.attr("name"),n=i.val();o in r.options.verify&&!0!==i.prop("disabled")&&(s.text("").removeClass("positive").removeClass("negative").removeClass("visible"),r.flag(i,"unverified",!0),r.$obj.parent().trigger("--refresh-scrollbar"),"_form_verifyTimeout"in this&&window.clearTimeout(this._form_verifyTimeout),r.options.verify[o]("abort"),this._form_verifyTimeout=window.setTimeout(function(){if("1"!=i.data("invalid")&&""!=n&&(n=i.val(),"1"!=i.data("invalid")&&""!=n)){if(r.flag(i,"verifailed",!1),n==i.data("verify-originalValue"))return r.flag(i,"unverified",!1),void r.validate(i);s.text("Checking ...").addClass("visible").addClass("pending"),r.$obj.parent().trigger("--refresh-scrollbar"),r.options.verify[o]("verify",n,function(t,e,a){t?(r.flag(i,"unverified",!1),r.validate(i),r.flag(i,"verifailed",!1),i.is(":focus")||i.trigger("change",["form.init.verified"]),"change"in r.options.fields[o]&&r.options.fields[o].change(n),s.removeClass("pending").removeClass("negative").removeClass("caution").removeClass("premium").addClass(a||"positive").html(e)):(r.flag(i,"unverified",!0),r.validate(i),r.flag(i,"verifailed",!0),i.is(":focus")||i.trigger("change",["form.init.unverified"]),"change"in r.options.fields[o]&&r.options.fields[o].change(""),s.removeClass("pending").removeClass("negative").removeClass("caution").removeClass("premium").addClass(a||"negative").html(e))})}},500))}),this.options.verify)a=(e=this.$obj.find('input[name="'+t+'"]')).parent(),0!=e.length&&$('<div class="message"></div>').insertAfter(a.hasClass("input-wrapper")?a:e);this.$obj.triggerHandler("--refresh-verify")}this.$obj.attr("action")&&this.$obj.data("action",this.$obj.attr("action")).removeAttr("action"),this.$obj.on("change","input,select,textarea",function(){var t,e=$(this),a=e.attr("name"),i=e.data("missing")||e.data("invalid")?"":e.val();a in r.options.fields&&"trim"in r.options.fields[a]&&1==r.options.fields[a].trim&&(i=(i=(i=i.replace(/\t+/g," ")).replace(/ +/g," ")).trim(),e.val(i)),e.data("unverified")||"name"in r.options.fields&&("preprocess"in r.options.fields[a]&&(t=r.options.fields[a].preprocess(i))!=i&&(i=t,e.val(i)),"change"in r.options.fields[a]&&r.options.fields[a].change(i))}),this.$obj.on("submit",function(t){var e=r.$obj.find("input,select,textarea");r.options.validation&&(e.each(function(){r.validate($(this))}),r.isValid()||(t.stopPropagation(),t.preventDefault())),r.options.submitHandler&&(t.stopPropagation(),t.preventDefault(),e.blur(),r.disableSubmits(!0),e.filter(":disabled").removeData("verify-originalValue"),r.clearAlert(),r.options.submitHandler(function(){r.enableSubmits()}))}),this.options.validation&&window.setTimeout(function(){r.$obj.find("input,select,textarea").each(function(){r.validate($(this))})},0)},$.fn.form=function(t){var e=$(this);if(0==this.length)return e;if(1<this.length){for(var a=0;a<this.length;a++)$(this[a]).form(t);return e}return this[0]._form=new i(e,t),e},$.valHandlers.push({condition:function(){return this&&this.dataset&&void 0!==this.dataset.valueMap},init:function(){var t,e,a,i;if(!("_valueMap"in this))for(this._valueMap={},t=this.dataset.valueMap.split("&"),i=0;i<t.length;i++)1==(a=(e=t[i].split("="))[1].split("-")).length&&(a[1]=a[0]),a[0]=parseFloat(a[0]),a[1]=parseFloat(a[1]),this._valueMap[e[0]]=a},get:function(t){var e,a;for(a in e=$.fn.origVal.call($(this)),this._valueMap)if(e>=this._valueMap[a][0]&&e<=this._valueMap[a][1])return a;return e},set:function(t){return $.fn.origVal.call($(this),t in this._valueMap?this._valueMap[t][0]:t)}}),$.valHandlers.push({condition:function(){return this&&this.dataset&&void 0!==this.dataset.suffixes},get:function(){var t,e,a=$(this),i=a.next("select");return(t=$.fn.origVal.call(a))?t+((e=$.fn.origVal.call(i))?","+e:""):""},set:function(t){var e,a,i,s=$(this),o=s.next("select");return null===t&&(t=""),2<(e=t.split(",")).length||!e[0]&&e[1]||(null!==(i=1==e.length?""==e[0]?(a="",null):(a=e[0],""):(a=e[0],1==o.children('option[value="'+e[1]+'"]').length?e[1]:""))&&($.fn.origVal.call(o,i),o.triggerHandler("change",["form.valHandlers.suffixes"])),$.fn.origVal.call(s,a)),s}}),$.fn.origVal=$.fn.val,$.fn.val=function(t){var e,a,i;if(0==this.length)return void 0!==t?$.fn.origVal.call(this,t):$.fn.origVal.call(this);if(void 0!==t){for(e=0;e<this.length;e++){for(a in i=!1,$.valHandlers)if($.valHandlers[a].condition.apply(this[e])){"init"in $.valHandlers[a]&&$.valHandlers[a].init.call(this[e]),$.valHandlers[a].set.call(this[e],t),i=!0;break}i||$.fn.origVal.call($(this[e]),t)}return this}for(a in $.valHandlers)if($.valHandlers[a].condition.apply(this[0]))return"init"in $.valHandlers[a]&&$.valHandlers[a].init.call(this[0]),$.valHandlers[a].get.call(this[0]);return $.fn.origVal.call(this)},e.exports=i},{"./formArray.js":"formArray","./formColorPicker.js":"formColorPicker","./formImageUploader.js":"formImageUploader","./formVideoUploader.js":"formVideoUploader"}],tabs:[function(t,e,a){function i(t,a){var i=this,s=$('<ul class="tabs'+(a?" depth-"+a:"")+'"></ul>').prependTo(t);void 0===a&&(a=0),this.tabs=[],this.$tabs=$(),this.$panes=$(),t.children("section[data-title]").each(function(t){var e={$tab:null,$pane:null,title:null};e.$pane=$(this),e.$pane.hide(),i.$panes=i.$panes.add(e.$pane),0<e.$pane.children("section[data-title]").length&&e.$pane.tabs(a+1),e.title=e.$pane.data("title"),e.$tab=$('<li tabindex="0">'+e.title+"</li>").appendTo(s),e.$tab.on("blur",function(t){$(this).removeClass("is-clicked")}).on("mousedown",function(t){$(this).addClass("is-clicked")}).on("click",function(){i.switch(t)}).on("keydown",function(t){switch(t.keyCode){case 13:case 32:t.preventDefault(),t.stopPropagation(),$(this).trigger("click");break;default:return app.keyHandler.apply(this,[t])}}),i.$tabs=i.$tabs.add(e.$tab),i.tabs.push(e)}),this.switch(0)}i.prototype.switch=function(t){var e=this.tabs[t];this.$tabs.removeClass("active"),this.$panes.css("display","none"),e.$tab.addClass("active"),e.$pane.css("display",""),e.$pane.find("textarea[data-autosize]").trigger("--refresh-input")},$.fn.tabs=function(t){var e=$(this);if(0==this.length)return e;if(1<this.length){for(var a=0;a<this.length;a++)$(this[a]).tabs(t);return e}return this[0]._tabs=new i(e,t),e},e.exports=i},{}]},{},[1]);